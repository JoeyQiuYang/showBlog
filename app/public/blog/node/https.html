<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTPS | QLQ学习平台</title>
    <meta name="description" content="QLQ学习平台">
    <link rel="manifest" href="/public/blog/manifest.json">
    
    <link rel="preload" href="/public/blog/assets/css/0.styles.3ad33863.css" as="style"><link rel="preload" href="/public/blog/assets/js/app.e4ea57ce.js" as="script"><link rel="preload" href="/public/blog/assets/js/2.d1dd4e4d.js" as="script"><link rel="preload" href="/public/blog/assets/js/32.9d8aa648.js" as="script"><link rel="preload" href="/public/blog/assets/js/3.1f730cd9.js" as="script"><link rel="prefetch" href="/public/blog/assets/js/10.7d4b1d4b.js"><link rel="prefetch" href="/public/blog/assets/js/11.b74ab56f.js"><link rel="prefetch" href="/public/blog/assets/js/12.5effa0dc.js"><link rel="prefetch" href="/public/blog/assets/js/13.6eb918e8.js"><link rel="prefetch" href="/public/blog/assets/js/14.0de95251.js"><link rel="prefetch" href="/public/blog/assets/js/15.fa3eaaf6.js"><link rel="prefetch" href="/public/blog/assets/js/16.fa5a1f3f.js"><link rel="prefetch" href="/public/blog/assets/js/17.65e33a7a.js"><link rel="prefetch" href="/public/blog/assets/js/18.a604e43f.js"><link rel="prefetch" href="/public/blog/assets/js/19.43fdc1b1.js"><link rel="prefetch" href="/public/blog/assets/js/20.c6e0b4b7.js"><link rel="prefetch" href="/public/blog/assets/js/21.81d73e54.js"><link rel="prefetch" href="/public/blog/assets/js/22.2da1489e.js"><link rel="prefetch" href="/public/blog/assets/js/23.98032a48.js"><link rel="prefetch" href="/public/blog/assets/js/24.bf1aeeb3.js"><link rel="prefetch" href="/public/blog/assets/js/25.ff0a5a9e.js"><link rel="prefetch" href="/public/blog/assets/js/26.9a69e70f.js"><link rel="prefetch" href="/public/blog/assets/js/27.78d71253.js"><link rel="prefetch" href="/public/blog/assets/js/28.05172e35.js"><link rel="prefetch" href="/public/blog/assets/js/29.836b5f2c.js"><link rel="prefetch" href="/public/blog/assets/js/30.7f2a0aa5.js"><link rel="prefetch" href="/public/blog/assets/js/31.16e7c775.js"><link rel="prefetch" href="/public/blog/assets/js/33.3ad73093.js"><link rel="prefetch" href="/public/blog/assets/js/34.a27e23cf.js"><link rel="prefetch" href="/public/blog/assets/js/35.34f0ba53.js"><link rel="prefetch" href="/public/blog/assets/js/36.993eb43f.js"><link rel="prefetch" href="/public/blog/assets/js/37.70ac44f6.js"><link rel="prefetch" href="/public/blog/assets/js/38.4b9e0ad1.js"><link rel="prefetch" href="/public/blog/assets/js/39.f8c33c98.js"><link rel="prefetch" href="/public/blog/assets/js/4.a6ed393e.js"><link rel="prefetch" href="/public/blog/assets/js/40.a2197e85.js"><link rel="prefetch" href="/public/blog/assets/js/41.467d6440.js"><link rel="prefetch" href="/public/blog/assets/js/42.ba8fc1fa.js"><link rel="prefetch" href="/public/blog/assets/js/43.b9d80aa8.js"><link rel="prefetch" href="/public/blog/assets/js/44.9b55cec1.js"><link rel="prefetch" href="/public/blog/assets/js/45.fbd44db5.js"><link rel="prefetch" href="/public/blog/assets/js/46.cff257a8.js"><link rel="prefetch" href="/public/blog/assets/js/47.3cd816de.js"><link rel="prefetch" href="/public/blog/assets/js/48.fdd057cb.js"><link rel="prefetch" href="/public/blog/assets/js/49.e007afae.js"><link rel="prefetch" href="/public/blog/assets/js/5.868620b4.js"><link rel="prefetch" href="/public/blog/assets/js/50.05e06075.js"><link rel="prefetch" href="/public/blog/assets/js/51.28689d1c.js"><link rel="prefetch" href="/public/blog/assets/js/52.84b0ef5c.js"><link rel="prefetch" href="/public/blog/assets/js/53.586cad0a.js"><link rel="prefetch" href="/public/blog/assets/js/54.2b8a703d.js"><link rel="prefetch" href="/public/blog/assets/js/55.c466c411.js"><link rel="prefetch" href="/public/blog/assets/js/56.882ab9d2.js"><link rel="prefetch" href="/public/blog/assets/js/57.edaca7e3.js"><link rel="prefetch" href="/public/blog/assets/js/58.c7ce4964.js"><link rel="prefetch" href="/public/blog/assets/js/59.02f33b29.js"><link rel="prefetch" href="/public/blog/assets/js/6.8e0ec0a1.js"><link rel="prefetch" href="/public/blog/assets/js/60.3e43121d.js"><link rel="prefetch" href="/public/blog/assets/js/61.e73a45bf.js"><link rel="prefetch" href="/public/blog/assets/js/62.a1ea2161.js"><link rel="prefetch" href="/public/blog/assets/js/63.0a4a98df.js"><link rel="prefetch" href="/public/blog/assets/js/64.0422c733.js"><link rel="prefetch" href="/public/blog/assets/js/65.b26f077a.js"><link rel="prefetch" href="/public/blog/assets/js/7.287519a5.js"><link rel="prefetch" href="/public/blog/assets/js/8.5443f788.js"><link rel="prefetch" href="/public/blog/assets/js/9.ef0461e8.js">
    <link rel="stylesheet" href="/public/blog/assets/css/0.styles.3ad33863.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/public/blog/" class="home-link router-link-active"><!----> <span class="site-name">QLQ学习平台</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/public/blog/js/regexp.html" class="nav-link">javaScript</a></div><div class="nav-item"><a href="/public/blog/css/bfc.html" class="nav-link">css</a></div><div class="nav-item"><a href="/public/blog/webpack/base-config.html" class="nav-link">webpack</a></div><div class="nav-item"><a href="/public/blog/node/buffer.html" class="nav-link">node</a></div><div class="nav-item"><a href="/public/blog/fragment/angular.html" class="nav-link">js框架</a></div><div class="nav-item"><a href="/public/blog/pwa/PWA.html" class="nav-link">pwa</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/public/blog/js/regexp.html" class="nav-link">javaScript</a></div><div class="nav-item"><a href="/public/blog/css/bfc.html" class="nav-link">css</a></div><div class="nav-item"><a href="/public/blog/webpack/base-config.html" class="nav-link">webpack</a></div><div class="nav-item"><a href="/public/blog/node/buffer.html" class="nav-link">node</a></div><div class="nav-item"><a href="/public/blog/fragment/angular.html" class="nav-link">js框架</a></div><div class="nav-item"><a href="/public/blog/pwa/PWA.html" class="nav-link">pwa</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/public/blog/node/buffer.html" class="sidebar-link">Buffer</a></li><li><a href="/public/blog/node/stream.html" class="sidebar-link">Stream</a></li><li><a href="/public/blog/node/nodemon.html" class="sidebar-link">nodemon：高效的nodejs开发环境</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="https"><a href="#https" class="header-anchor">#</a> HTTPS</h1> <blockquote><p>Stability: 2 - Stable</p></blockquote> <p>HTTPS is the HTTP protocol over TLS/SSL. In Node.js this is implemented as a
separate module.</p> <h2 id="class-https-agent"><a href="#class-https-agent" class="header-anchor">#</a> Class: https.Agent</h2> <p>An <a href="#https_class_https_agent"><code>Agent</code></a> object for HTTPS similar to <a href="/public/blog/node/http.html#http_class_http_agent"><code>http.Agent</code></a>. See
<a href="#https_https_request_options_callback"><code>https.request()</code></a> for more information.</p> <h3 id="new-agent-options"><a href="#new-agent-options" class="header-anchor">#</a> new Agent([options])</h3> <ul><li><code>options</code> {Object} Set of configurable options to set on the agent.
Can have the same fields as for <a href="/public/blog/node/http.html#http_new_agent_options"><code>http.Agent(options)</code></a>, and
<ul><li><p><code>maxCachedSessions</code> {number} maximum number of TLS cached sessions.
Use <code>0</code> to disable TLS session caching. <strong>Default:</strong> <code>100</code>.</p></li> <li><p><code>servername</code> {string} the value of
<a href="https://en.wikipedia.org/wiki/Server_Name_Indication" target="_blank" rel="noopener noreferrer">Server Name Indication extension<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to be sent to the server. Use
empty string <code>''</code> to disable sending the extension.
<strong>Default:</strong> hostname of the target server, unless the target server
is specified using an IP address, in which case the default is <code>''</code> (no
extension).</p> <p>See <a href="/public/blog/node/tls.html#tls_session_resumption"><code>Session Resumption</code></a> for information about TLS session reuse.</p></li></ul></li></ul> <h2 id="class-https-server"><a href="#class-https-server" class="header-anchor">#</a> Class: https.Server</h2> <ul><li>Extends: {tls.Server}</li></ul> <p>See <a href="/public/blog/node/http.html#http_class_http_server"><code>http.Server</code></a> for more information.</p> <h3 id="server-close-callback"><a href="#server-close-callback" class="header-anchor">#</a> server.close([callback])</h3> <ul><li><code>callback</code> {Function}</li> <li>Returns: {https.Server}</li></ul> <p>See <a href="/public/blog/node/http.html#http_server_close_callback"><code>server.close()</code></a> from the HTTP module for details.</p> <h3 id="server-headerstimeout"><a href="#server-headerstimeout" class="header-anchor">#</a> server.headersTimeout</h3> <ul><li>{number} <strong>Default:</strong> <code>40000</code></li></ul> <p>See <a href="/public/blog/node/http.html#http_server_headerstimeout"><code>http.Server#headersTimeout</code></a>.</p> <h3 id="server-listen"><a href="#server-listen" class="header-anchor">#</a> server.listen()</h3> <p>Starts the HTTPS server listening for encrypted connections.
This method is identical to <a href="/public/blog/node/net.html#net_server_listen"><code>server.listen()</code></a> from <a href="/public/blog/node/net.html#net_class_net_server"><code>net.Server</code></a>.</p> <h3 id="server-maxheaderscount"><a href="#server-maxheaderscount" class="header-anchor">#</a> server.maxHeadersCount</h3> <ul><li>{number} <strong>Default:</strong> <code>2000</code></li></ul> <p>See <a href="/public/blog/node/http.html#http_server_maxheaderscount"><code>http.Server#maxHeadersCount</code></a>.</p> <h3 id="server-settimeout-msecs-callback"><a href="#server-settimeout-msecs-callback" class="header-anchor">#</a> server.setTimeout([msecs][, callback])</h3> <ul><li><code>msecs</code> {number} <strong>Default:</strong> <code>120000</code> (2 minutes)</li> <li><code>callback</code> {Function}</li> <li>Returns: {https.Server}</li></ul> <p>See <a href="/public/blog/node/http.html#http_server_settimeout_msecs_callback"><code>http.Server#setTimeout()</code></a>.</p> <h3 id="server-timeout"><a href="#server-timeout" class="header-anchor">#</a> server.timeout</h3> <ul><li>{number} <strong>Default:</strong> <code>120000</code> (2 minutes)</li></ul> <p>See <a href="/public/blog/node/http.html#http_server_timeout"><code>http.Server#timeout</code></a>.</p> <h3 id="server-keepalivetimeout"><a href="#server-keepalivetimeout" class="header-anchor">#</a> server.keepAliveTimeout</h3> <ul><li>{number} <strong>Default:</strong> <code>5000</code> (5 seconds)</li></ul> <p>See <a href="/public/blog/node/http.html#http_server_keepalivetimeout"><code>http.Server#keepAliveTimeout</code></a>.</p> <h2 id="https-createserver-options-requestlistener"><a href="#https-createserver-options-requestlistener" class="header-anchor">#</a> https.createServer([options][, requestListener])</h2> <ul><li><code>options</code> {Object} Accepts <code>options</code> from <a href="/public/blog/node/tls.html#tls_tls_createserver_options_secureconnectionlistener"><code>tls.createServer()</code></a>,
<a href="/public/blog/node/tls.html#tls_tls_createsecurecontext_options"><code>tls.createSecureContext()</code></a> and <a href="/public/blog/node/http.html#http_http_createserver_options_requestlistener"><code>http.createServer()</code></a>.</li> <li><code>requestListener</code> {Function} A listener to be added to the <code>'request'</code> event.</li> <li>Returns: {https.Server}</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// curl -k https://localhost:8000/</span>
<span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  key<span class="token punctuation">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test/fixtures/keys/agent2-key.pem'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  cert<span class="token punctuation">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test/fixtures/keys/agent2-cert.pem'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello world\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Or</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  pfx<span class="token punctuation">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test/fixtures/test_cert.pfx'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  passphrase<span class="token punctuation">:</span> <span class="token string">'sample'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello world\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="https-get-options-callback"><a href="#https-get-options-callback" class="header-anchor">#</a> https.get(options[, callback])</h2> <h2 id="https-get-url-options-callback"><a href="#https-get-url-options-callback" class="header-anchor">#</a> https.get(url[, options][, callback])</h2> <ul><li><code>url</code> {string | URL}</li> <li><code>options</code> {Object | string | URL} Accepts the same <code>options</code> as
<a href="#https_https_request_options_callback"><code>https.request()</code></a>, with the <code>method</code> always set to <code>GET</code>.</li> <li><code>callback</code> {Function}</li></ul> <p>Like <a href="/public/blog/node/http.html#http_http_get_options_callback"><code>http.get()</code></a> but for HTTPS.</p> <p><code>options</code> can be an object, a string, or a <a href="/public/blog/node/url.html#url_the_whatwg_url_api"><code>URL</code></a> object. If <code>options</code> is a
string, it is automatically parsed with <a href="/public/blog/node/url.html#url_constructor_new_url_input_base"><code>new URL()</code></a>. If it is a <a href="/public/blog/node/url.html#url_the_whatwg_url_api"><code>URL</code></a>
object, it will be automatically converted to an ordinary <code>options</code> object.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

https<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://encrypted.google.com/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'statusCode:'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'headers:'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>

  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="https-globalagent"><a href="#https-globalagent" class="header-anchor">#</a> https.globalAgent</h2> <p>Global instance of <a href="#https_class_https_agent"><code>https.Agent</code></a> for all HTTPS client requests.</p> <h2 id="https-request-options-callback"><a href="#https-request-options-callback" class="header-anchor">#</a> https.request(options[, callback])</h2> <h2 id="https-request-url-options-callback"><a href="#https-request-url-options-callback" class="header-anchor">#</a> https.request(url[, options][, callback])</h2> <ul><li><code>url</code> {string | URL}</li> <li><code>options</code> {Object | string | URL} Accepts all <code>options</code> from
<a href="/public/blog/node/http.html#http_http_request_options_callback"><code>http.request()</code></a>, with some differences in default values:
<ul><li><code>protocol</code> <strong>Default:</strong> <code>'https:'</code></li> <li><code>port</code> <strong>Default:</strong> <code>443</code></li> <li><code>agent</code> <strong>Default:</strong> <code>https.globalAgent</code></li></ul></li> <li><code>callback</code> {Function}</li></ul> <p>Makes a request to a secure web server.</p> <p>The following additional <code>options</code> from <a href="/public/blog/node/tls.html#tls_tls_connect_options_callback"><code>tls.connect()</code></a> are also accepted:
<code>ca</code>, <code>cert</code>, <code>ciphers</code>, <code>clientCertEngine</code>, <code>crl</code>, <code>dhparam</code>, <code>ecdhCurve</code>,
<code>honorCipherOrder</code>, <code>key</code>, <code>passphrase</code>, <code>pfx</code>, <code>rejectUnauthorized</code>,
<code>secureOptions</code>, <code>secureProtocol</code>, <code>servername</code>, <code>sessionIdContext</code>.</p> <p><code>options</code> can be an object, a string, or a <a href="/public/blog/node/url.html#url_the_whatwg_url_api"><code>URL</code></a> object. If <code>options</code> is a
string, it is automatically parsed with <a href="/public/blog/node/url.html#url_constructor_new_url_input_base"><code>new URL()</code></a>. If it is a <a href="/public/blog/node/url.html#url_the_whatwg_url_api"><code>URL</code></a>
object, it will be automatically converted to an ordinary <code>options</code> object.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  hostname<span class="token punctuation">:</span> <span class="token string">'encrypted.google.com'</span><span class="token punctuation">,</span>
  port<span class="token punctuation">:</span> <span class="token number">443</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  method<span class="token punctuation">:</span> <span class="token string">'GET'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> req <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'statusCode:'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'headers:'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>

  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Example using options from <a href="/public/blog/node/tls.html#tls_tls_connect_options_callback"><code>tls.connect()</code></a>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  hostname<span class="token punctuation">:</span> <span class="token string">'encrypted.google.com'</span><span class="token punctuation">,</span>
  port<span class="token punctuation">:</span> <span class="token number">443</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  method<span class="token punctuation">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
  key<span class="token punctuation">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test/fixtures/keys/agent2-key.pem'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  cert<span class="token punctuation">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test/fixtures/keys/agent2-cert.pem'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
options<span class="token punctuation">.</span>agent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">https<span class="token punctuation">.</span>Agent</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> req <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Alternatively, opt out of connection pooling by not using an <a href="#https_class_https_agent"><code>Agent</code></a>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  hostname<span class="token punctuation">:</span> <span class="token string">'encrypted.google.com'</span><span class="token punctuation">,</span>
  port<span class="token punctuation">:</span> <span class="token number">443</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  method<span class="token punctuation">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
  key<span class="token punctuation">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test/fixtures/keys/agent2-key.pem'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  cert<span class="token punctuation">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test/fixtures/keys/agent2-cert.pem'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  agent<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> req <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Example using a <a href="/public/blog/node/url.html#url_the_whatwg_url_api"><code>URL</code></a> as <code>options</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'https://abc:xyz@example.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> req <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Example pinning on certificate fingerprint, or the public key (similar to
<code>pin-sha256</code>):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> tls <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'tls'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">sha256</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  hostname<span class="token punctuation">:</span> <span class="token string">'github.com'</span><span class="token punctuation">,</span>
  port<span class="token punctuation">:</span> <span class="token number">443</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  method<span class="token punctuation">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">checkServerIdentity</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">host<span class="token punctuation">,</span> cert</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Make sure the certificate is issued to the host we are connected to</span>
    <span class="token keyword">const</span> err <span class="token operator">=</span> tls<span class="token punctuation">.</span><span class="token function">checkServerIdentity</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> cert<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Pin the public key, similar to HPKP pin-sha25 pinning</span>
    <span class="token keyword">const</span> pubkey256 <span class="token operator">=</span> <span class="token string">'pL1+qb9HTMRZJmuC/bB/ZI9d302BYrrqiVuRyW+DGrU='</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sha256</span><span class="token punctuation">(</span>cert<span class="token punctuation">.</span>pubkey<span class="token punctuation">)</span> <span class="token operator">!==</span> pubkey256<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token string">'Certificate verification error: '</span> <span class="token operator">+</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The public key of '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cert<span class="token punctuation">.</span>subject<span class="token punctuation">.</span><span class="token constant">CN</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
        <span class="token string">'does not match our pinned fingerprint'</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Pin the exact certificate, rather then the pub key</span>
    <span class="token keyword">const</span> cert256 <span class="token operator">=</span> <span class="token string">'25:FE:39:32:D9:63:8C:8A:FC:A1:9A:29:87:'</span> <span class="token operator">+</span>
      <span class="token string">'D8:3E:4C:1D:98:DB:71:E4:1A:48:03:98:EA:22:6A:BD:8B:93:16'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cert<span class="token punctuation">.</span>fingerprint256 <span class="token operator">!==</span> cert256<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token string">'Certificate verification error: '</span> <span class="token operator">+</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The certificate of '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cert<span class="token punctuation">.</span>subject<span class="token punctuation">.</span><span class="token constant">CN</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
        <span class="token string">'does not match our pinned fingerprint'</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// This loop is informational only.</span>
    <span class="token comment">// Print the certificate and public key fingerprints of all certs in the</span>
    <span class="token comment">// chain. Its common to pin the public key of the issuer on the public</span>
    <span class="token comment">// internet, while pinning the public key of the service in sensitive</span>
    <span class="token comment">// environments.</span>
    <span class="token keyword">do</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Subject Common Name:'</span><span class="token punctuation">,</span> cert<span class="token punctuation">.</span>subject<span class="token punctuation">.</span><span class="token constant">CN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'  Certificate SHA256 fingerprint:'</span><span class="token punctuation">,</span> cert<span class="token punctuation">.</span>fingerprint256<span class="token punctuation">)</span><span class="token punctuation">;</span>

      hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'  Public key ping-sha256:'</span><span class="token punctuation">,</span> <span class="token function">sha256</span><span class="token punctuation">(</span>cert<span class="token punctuation">.</span>pubkey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      lastprint256 <span class="token operator">=</span> cert<span class="token punctuation">.</span>fingerprint256<span class="token punctuation">;</span>
      cert <span class="token operator">=</span> cert<span class="token punctuation">.</span>issuerCertificate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>cert<span class="token punctuation">.</span>fingerprint256 <span class="token operator">!==</span> lastprint256<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

options<span class="token punctuation">.</span>agent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">https<span class="token punctuation">.</span>Agent</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'All OK. Server matched our pinned cert or public key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'statusCode:'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Print the HPKP values</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'headers:'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'public-key-pins'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Outputs for example:</p> <div class="language-text extra-class"><pre class="language-text"><code>Subject Common Name: github.com
  Certificate SHA256 fingerprint: 25:FE:39:32:D9:63:8C:8A:FC:A1:9A:29:87:D8:3E:4C:1D:98:DB:71:E4:1A:48:03:98:EA:22:6A:BD:8B:93:16
  Public key ping-sha256: pL1+qb9HTMRZJmuC/bB/ZI9d302BYrrqiVuRyW+DGrU=
Subject Common Name: DigiCert SHA2 Extended Validation Server CA
  Certificate SHA256 fingerprint: 40:3E:06:2A:26:53:05:91:13:28:5B:AF:80:A0:D4:AE:42:2C:84:8C:9F:78:FA:D0:1F:C9:4B:C5:B8:7F:EF:1A
  Public key ping-sha256: RRM1dGqnDFsCJXBTHky16vi1obOlCgFFn/yOhI/y+ho=
Subject Common Name: DigiCert High Assurance EV Root CA
  Certificate SHA256 fingerprint: 74:31:E5:F4:C3:C1:CE:46:90:77:4F:0B:61:E0:54:40:88:3B:A9:A0:1E:D0:0B:A6:AB:D7:80:6E:D3:B1:18:CF
  Public key ping-sha256: WoiWRyIOVNa9ihaBciRSC7XHjliYS9VwUGOIud4PB18=
All OK. Server matched our pinned cert or public key
statusCode: 200
headers: max-age=0; pin-sha256=&quot;WoiWRyIOVNa9ihaBciRSC7XHjliYS9VwUGOIud4PB18=&quot;; pin-sha256=&quot;RRM1dGqnDFsCJXBTHky16vi1obOlCgFFn/yOhI/y+ho=&quot;; pin-sha256=&quot;k2v657xBsOVe1PQRwOsHsw3bsGT2VzIqz5K+59sNQws=&quot;; pin-sha256=&quot;K87oWBWM9UZfyddvDfoxL+8lpNyoUB2ptGtn0fv6G2Q=&quot;; pin-sha256=&quot;IQBnNBEiFuhj+8x6X8XLgh01V9Ic5/V3IRQLNFFc7v4=&quot;; pin-sha256=&quot;iie1VXtL7HzAMF+/PVPR9xzT80kQxdZeJ+zduCB3uj0=&quot;; pin-sha256=&quot;LvRiGEjRqfzurezaWuj8Wie2gyHMrW5Q06LspMnox7A=&quot;; includeSubDomains
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/public/blog/assets/js/app.e4ea57ce.js" defer></script><script src="/public/blog/assets/js/2.d1dd4e4d.js" defer></script><script src="/public/blog/assets/js/32.9d8aa648.js" defer></script><script src="/public/blog/assets/js/3.1f730cd9.js" defer></script>
  </body>
</html>
