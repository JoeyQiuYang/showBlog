(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{214:function(t,e,s){"use strict";s.r(e);var a=s(3),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"http-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-2"}},[t._v("#")]),t._v(" HTTP/2")]),t._v(" "),s("blockquote",[s("p",[t._v("Stability: 2 - Stable")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("http2")]),t._v(" module provides an implementation of the "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc7540",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP/2"),s("OutboundLink")],1),t._v(" protocol. It\ncan be accessed using:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"core-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#core-api"}},[t._v("#")]),t._v(" Core API")]),t._v(" "),s("p",[t._v("The Core API provides a low-level interface designed specifically around\nsupport for HTTP/2 protocol features. It is specifically "),s("em",[t._v("not")]),t._v(" designed for\ncompatibility with the existing "),s("router-link",{attrs:{to:"/node/http.html"}},[t._v("HTTP/1")]),t._v(" module API. However,\nthe "),s("a",{attrs:{href:"#http2_compatibility_api"}},[t._v("Compatibility API")]),t._v(" is.")],1),t._v(" "),s("p",[t._v("The "),s("code",[t._v("http2")]),t._v(" Core API is much more symmetric between client and server than the\n"),s("code",[t._v("http")]),t._v(" API. For instance, most events, like "),s("code",[t._v("'error'")]),t._v(", "),s("code",[t._v("'connect'")]),t._v(" and\n"),s("code",[t._v("'stream'")]),t._v(", can be emitted either by client-side code or server-side code.")]),t._v(" "),s("h3",{attrs:{id:"server-side-example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-side-example"}},[t._v("#")]),t._v(" Server-side example")]),t._v(" "),s("p",[t._v("The following illustrates a simple HTTP/2 server using the Core API.\nSince there are no browsers known that support\n"),s("a",{attrs:{href:"https://http2.github.io/faq/#does-http2-require-encryption",target:"_blank",rel:"noopener noreferrer"}},[t._v("unencrypted HTTP/2"),s("OutboundLink")],1),t._v(", the use of\n"),s("a",{attrs:{href:"#http2_http2_createsecureserver_options_onrequesthandler"}},[s("code",[t._v("http2.createSecureServer()")])]),t._v(" is necessary when communicating\nwith browser clients.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createSecureServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost-privkey.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost-cert.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// stream is a Duplex")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<h1>Hello World</h1>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8443")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("To generate the certificate and key for this example, run:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("openssl req -x509 -newkey rsa:2048 -nodes -sha256 -subj "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/CN=localhost'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -keyout localhost-privkey.pem -out localhost-cert.pem\n")])])]),s("h3",{attrs:{id:"client-side-example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#client-side-example"}},[t._v("#")]),t._v(" Client-side example")]),t._v(" "),s("p",[t._v("The following illustrates an HTTP/2 client:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://localhost:8443'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  ca"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost-cert.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nclient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" req "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'response'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(": ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setEncoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" chunk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\\n")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"class-http2session"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-http2session"}},[t._v("#")]),t._v(" Class: Http2Session")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {EventEmitter}")])]),t._v(" "),s("p",[t._v("Instances of the "),s("code",[t._v("http2.Http2Session")]),t._v(" class represent an active communications\nsession between an HTTP/2 client and server. Instances of this class are "),s("em",[t._v("not")]),t._v("\nintended to be constructed directly by user code.")]),t._v(" "),s("p",[t._v("Each "),s("code",[t._v("Http2Session")]),t._v(" instance will exhibit slightly different behaviors\ndepending on whether it is operating as a server or a client. The\n"),s("code",[t._v("http2session.type")]),t._v(" property can be used to determine the mode in which an\n"),s("code",[t._v("Http2Session")]),t._v(" is operating. On the server side, user code should rarely\nhave occasion to work with the "),s("code",[t._v("Http2Session")]),t._v(" object directly, with most\nactions typically taken through interactions with either the "),s("code",[t._v("Http2Server")]),t._v(" or\n"),s("code",[t._v("Http2Stream")]),t._v(" objects.")]),t._v(" "),s("p",[t._v("User code will not create "),s("code",[t._v("Http2Session")]),t._v(" instances directly. Server-side\n"),s("code",[t._v("Http2Session")]),t._v(" instances are created by the "),s("code",[t._v("Http2Server")]),t._v(" instance when a\nnew HTTP/2 connection is received. Client-side "),s("code",[t._v("Http2Session")]),t._v(" instances are\ncreated using the "),s("code",[t._v("http2.connect()")]),t._v(" method.")]),t._v(" "),s("h4",{attrs:{id:"http2session-and-sockets"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-and-sockets"}},[t._v("#")]),t._v(" Http2Session and Sockets")]),t._v(" "),s("p",[t._v("Every "),s("code",[t._v("Http2Session")]),t._v(" instance is associated with exactly one "),s("router-link",{attrs:{to:"/node/net.html#net_class_net_socket"}},[s("code",[t._v("net.Socket")])]),t._v(" or\n"),s("router-link",{attrs:{to:"/node/tls.html#tls_class_tls_tlssocket"}},[s("code",[t._v("tls.TLSSocket")])]),t._v(" when it is created. When either the "),s("code",[t._v("Socket")]),t._v(" or the\n"),s("code",[t._v("Http2Session")]),t._v(" are destroyed, both will be destroyed.")],1),t._v(" "),s("p",[t._v("Because of the specific serialization and processing requirements imposed\nby the HTTP/2 protocol, it is not recommended for user code to read data from\nor write data to a "),s("code",[t._v("Socket")]),t._v(" instance bound to a "),s("code",[t._v("Http2Session")]),t._v(". Doing so can\nput the HTTP/2 session into an indeterminate state causing the session and\nthe socket to become unusable.")]),t._v(" "),s("p",[t._v("Once a "),s("code",[t._v("Socket")]),t._v(" has been bound to an "),s("code",[t._v("Http2Session")]),t._v(", user code should rely\nsolely on the API of the "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-close"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-close"}},[t._v("#")]),t._v(" Event: 'close'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'close'")]),t._v(" event is emitted once the "),s("code",[t._v("Http2Session")]),t._v(" has been destroyed. Its\nlistener does not expect any arguments.")]),t._v(" "),s("h4",{attrs:{id:"event-connect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-connect"}},[t._v("#")]),t._v(" Event: 'connect'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("session")]),t._v(" {Http2Session}")]),t._v(" "),s("li",[s("code",[t._v("socket")]),t._v(" {net.Socket}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'connect'")]),t._v(" event is emitted once the "),s("code",[t._v("Http2Session")]),t._v(" has been successfully\nconnected to the remote peer and communication may begin.")]),t._v(" "),s("p",[t._v("User code will typically not listen for this event directly.")]),t._v(" "),s("h4",{attrs:{id:"event-error"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-error"}},[t._v("#")]),t._v(" Event: 'error'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("error")]),t._v(" {Error}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'error'")]),t._v(" event is emitted when an error occurs during the processing of\nan "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-frameerror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-frameerror"}},[t._v("#")]),t._v(" Event: 'frameError'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("type")]),t._v(" {integer} The frame type.")]),t._v(" "),s("li",[s("code",[t._v("code")]),t._v(" {integer} The error code.")]),t._v(" "),s("li",[s("code",[t._v("id")]),t._v(" {integer} The stream id (or "),s("code",[t._v("0")]),t._v(" if the frame isn't associated with a\nstream).")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'frameError'")]),t._v(" event is emitted when an error occurs while attempting to\nsend a frame on the session. If the frame that could not be sent is associated\nwith a specific "),s("code",[t._v("Http2Stream")]),t._v(", an attempt to emit a "),s("code",[t._v("'frameError'")]),t._v(" event on the\n"),s("code",[t._v("Http2Stream")]),t._v(" is made.")]),t._v(" "),s("p",[t._v("If the "),s("code",[t._v("'frameError'")]),t._v(" event is associated with a stream, the stream will be\nclosed and destroyed immediately following the "),s("code",[t._v("'frameError'")]),t._v(" event. If the\nevent is not associated with a stream, the "),s("code",[t._v("Http2Session")]),t._v(" will be shut down\nimmediately following the "),s("code",[t._v("'frameError'")]),t._v(" event.")]),t._v(" "),s("h4",{attrs:{id:"event-goaway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-goaway"}},[t._v("#")]),t._v(" Event: 'goaway'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("errorCode")]),t._v(" {number} The HTTP/2 error code specified in the "),s("code",[t._v("GOAWAY")]),t._v(" frame.")]),t._v(" "),s("li",[s("code",[t._v("lastStreamID")]),t._v(" {number} The ID of the last stream the remote peer successfully\nprocessed (or "),s("code",[t._v("0")]),t._v(" if no ID is specified).")]),t._v(" "),s("li",[s("code",[t._v("opaqueData")]),t._v(" {Buffer} If additional opaque data was included in the "),s("code",[t._v("GOAWAY")]),t._v("\nframe, a "),s("code",[t._v("Buffer")]),t._v(" instance will be passed containing that data.")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'goaway'")]),t._v(" event is emitted when a "),s("code",[t._v("GOAWAY")]),t._v(" frame is received.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("Http2Session")]),t._v(" instance will be shut down automatically when the "),s("code",[t._v("'goaway'")]),t._v("\nevent is emitted.")]),t._v(" "),s("h4",{attrs:{id:"event-localsettings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-localsettings"}},[t._v("#")]),t._v(" Event: 'localSettings'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("settings")]),t._v(" {HTTP/2 Settings Object} A copy of the "),s("code",[t._v("SETTINGS")]),t._v(" frame received.")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'localSettings'")]),t._v(" event is emitted when an acknowledgment "),s("code",[t._v("SETTINGS")]),t._v(" frame\nhas been received.")]),t._v(" "),s("p",[t._v("When using "),s("code",[t._v("http2session.settings()")]),t._v(" to submit new settings, the modified\nsettings do not take effect until the "),s("code",[t._v("'localSettings'")]),t._v(" event is emitted.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("settings")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" enablePush"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nsession"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localSettings'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("settings")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Use the new settings */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"event-ping"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-ping"}},[t._v("#")]),t._v(" Event: 'ping'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("payload")]),t._v(" {Buffer} The "),s("code",[t._v("PING")]),t._v(" frame 8-byte payload")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'ping'")]),t._v(" event is emitted whenever a "),s("code",[t._v("PING")]),t._v(" frame is received from the\nconnected peer.")]),t._v(" "),s("h4",{attrs:{id:"event-remotesettings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-remotesettings"}},[t._v("#")]),t._v(" Event: 'remoteSettings'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("settings")]),t._v(" {HTTP/2 Settings Object} A copy of the "),s("code",[t._v("SETTINGS")]),t._v(" frame received.")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'remoteSettings'")]),t._v(" event is emitted when a new "),s("code",[t._v("SETTINGS")]),t._v(" frame is received\nfrom the connected peer.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'remoteSettings'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("settings")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Use the new settings */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"event-stream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-stream"}},[t._v("#")]),t._v(" Event: 'stream'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("stream")]),t._v(" {Http2Stream} A reference to the stream")]),t._v(" "),s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object} An object describing the headers")]),t._v(" "),s("li",[s("code",[t._v("flags")]),t._v(" {number} The associated numeric flags")]),t._v(" "),s("li",[s("code",[t._v("rawHeaders")]),t._v(" {Array} An array containing the raw header names followed by\ntheir respective values.")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'stream'")]),t._v(" event is emitted when a new "),s("code",[t._v("Http2Stream")]),t._v(" is created.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nsession"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':method'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'world'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("On the server side, user code will typically not listen for this event directly,\nand would instead register a handler for the "),s("code",[t._v("'stream'")]),t._v(" event emitted by the\n"),s("code",[t._v("net.Server")]),t._v(" or "),s("code",[t._v("tls.Server")]),t._v(" instances returned by "),s("code",[t._v("http2.createServer()")]),t._v(" and\n"),s("code",[t._v("http2.createSecureServer()")]),t._v(", respectively, as in the example below:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create an unencrypted HTTP/2 server")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<h1>Hello World</h1>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Even though HTTP/2 streams and network sockets are not in a 1:1 correspondence,\na network error will destroy each individual stream and must be handled on the\nstream level, as shown above.")]),t._v(" "),s("h4",{attrs:{id:"event-timeout"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-timeout"}},[t._v("#")]),t._v(" Event: 'timeout'")]),t._v(" "),s("p",[t._v("After the "),s("code",[t._v("http2session.setTimeout()")]),t._v(" method is used to set the timeout period\nfor this "),s("code",[t._v("Http2Session")]),t._v(", the "),s("code",[t._v("'timeout'")]),t._v(" event is emitted if there is no\nactivity on the "),s("code",[t._v("Http2Session")]),t._v(" after the configured number of milliseconds.\nIts listener does not expect any arguments.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nsession"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timeout'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* .. */")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"http2session-alpnprotocol"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-alpnprotocol"}},[t._v("#")]),t._v(" http2session.alpnProtocol")]),t._v(" "),s("ul",[s("li",[t._v("{string|undefined}")])]),t._v(" "),s("p",[t._v("Value will be "),s("code",[t._v("undefined")]),t._v(" if the "),s("code",[t._v("Http2Session")]),t._v(" is not yet connected to a\nsocket, "),s("code",[t._v("h2c")]),t._v(" if the "),s("code",[t._v("Http2Session")]),t._v(" is not connected to a "),s("code",[t._v("TLSSocket")]),t._v(", or\nwill return the value of the connected "),s("code",[t._v("TLSSocket")]),t._v("'s own "),s("code",[t._v("alpnProtocol")]),t._v("\nproperty.")]),t._v(" "),s("h4",{attrs:{id:"http2session-close-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-close-callback"}},[t._v("#")]),t._v(" http2session.close([callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("callback")]),t._v(" {Function}")])]),t._v(" "),s("p",[t._v("Gracefully closes the "),s("code",[t._v("Http2Session")]),t._v(", allowing any existing streams to\ncomplete on their own and preventing new "),s("code",[t._v("Http2Stream")]),t._v(" instances from being\ncreated. Once closed, "),s("code",[t._v("http2session.destroy()")]),t._v(" "),s("em",[t._v("might")]),t._v(" be called if there\nare no open "),s("code",[t._v("Http2Stream")]),t._v(" instances.")]),t._v(" "),s("p",[t._v("If specified, the "),s("code",[t._v("callback")]),t._v(" function is registered as a handler for the\n"),s("code",[t._v("'close'")]),t._v(" event.")]),t._v(" "),s("h4",{attrs:{id:"http2session-closed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-closed"}},[t._v("#")]),t._v(" http2session.closed")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Will be "),s("code",[t._v("true")]),t._v(" if this "),s("code",[t._v("Http2Session")]),t._v(" instance has been closed, otherwise\n"),s("code",[t._v("false")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2session-connecting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-connecting"}},[t._v("#")]),t._v(" http2session.connecting")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Will be "),s("code",[t._v("true")]),t._v(" if this "),s("code",[t._v("Http2Session")]),t._v(" instance is still connecting, will be set\nto "),s("code",[t._v("false")]),t._v(" before emitting "),s("code",[t._v("connect")]),t._v(" event and/or calling the "),s("code",[t._v("http2.connect")]),t._v("\ncallback.")]),t._v(" "),s("h4",{attrs:{id:"http2session-destroy-error-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-destroy-error-code"}},[t._v("#")]),t._v(" http2session.destroy([error][, code])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("error")]),t._v(" {Error} An "),s("code",[t._v("Error")]),t._v(" object if the "),s("code",[t._v("Http2Session")]),t._v(" is being destroyed\ndue to an error.")]),t._v(" "),s("li",[s("code",[t._v("code")]),t._v(" {number} The HTTP/2 error code to send in the final "),s("code",[t._v("GOAWAY")]),t._v(" frame.\nIf unspecified, and "),s("code",[t._v("error")]),t._v(" is not undefined, the default is "),s("code",[t._v("INTERNAL_ERROR")]),t._v(",\notherwise defaults to "),s("code",[t._v("NO_ERROR")]),t._v(".")])]),t._v(" "),s("p",[t._v("Immediately terminates the "),s("code",[t._v("Http2Session")]),t._v(" and the associated "),s("code",[t._v("net.Socket")]),t._v(" or\n"),s("code",[t._v("tls.TLSSocket")]),t._v(".")]),t._v(" "),s("p",[t._v("Once destroyed, the "),s("code",[t._v("Http2Session")]),t._v(" will emit the "),s("code",[t._v("'close'")]),t._v(" event. If "),s("code",[t._v("error")]),t._v("\nis not undefined, an "),s("code",[t._v("'error'")]),t._v(" event will be emitted immediately before the\n"),s("code",[t._v("'close'")]),t._v(" event.")]),t._v(" "),s("p",[t._v("If there are any remaining open "),s("code",[t._v("Http2Streams")]),t._v(" associated with the\n"),s("code",[t._v("Http2Session")]),t._v(", those will also be destroyed.")]),t._v(" "),s("h4",{attrs:{id:"http2session-destroyed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-destroyed"}},[t._v("#")]),t._v(" http2session.destroyed")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Will be "),s("code",[t._v("true")]),t._v(" if this "),s("code",[t._v("Http2Session")]),t._v(" instance has been destroyed and must no\nlonger be used, otherwise "),s("code",[t._v("false")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2session-encrypted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-encrypted"}},[t._v("#")]),t._v(" http2session.encrypted")]),t._v(" "),s("ul",[s("li",[t._v("{boolean|undefined}")])]),t._v(" "),s("p",[t._v("Value is "),s("code",[t._v("undefined")]),t._v(" if the "),s("code",[t._v("Http2Session")]),t._v(" session socket has not yet been\nconnected, "),s("code",[t._v("true")]),t._v(" if the "),s("code",[t._v("Http2Session")]),t._v(" is connected with a "),s("code",[t._v("TLSSocket")]),t._v(",\nand "),s("code",[t._v("false")]),t._v(" if the "),s("code",[t._v("Http2Session")]),t._v(" is connected to any other kind of socket\nor stream.")]),t._v(" "),s("h4",{attrs:{id:"http2session-goaway-code-laststreamid-opaquedata"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-goaway-code-laststreamid-opaquedata"}},[t._v("#")]),t._v(" http2session.goaway([code[, lastStreamID[, opaqueData]]])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("code")]),t._v(" {number} An HTTP/2 error code")]),t._v(" "),s("li",[s("code",[t._v("lastStreamID")]),t._v(" {number} The numeric ID of the last processed "),s("code",[t._v("Http2Stream")])]),t._v(" "),s("li",[s("code",[t._v("opaqueData")]),t._v(" {Buffer|TypedArray|DataView} A "),s("code",[t._v("TypedArray")]),t._v(" or "),s("code",[t._v("DataView")]),t._v("\ninstance containing additional data to be carried within the "),s("code",[t._v("GOAWAY")]),t._v(" frame.")])]),t._v(" "),s("p",[t._v("Transmits a "),s("code",[t._v("GOAWAY")]),t._v(" frame to the connected peer "),s("em",[t._v("without")]),t._v(" shutting down the\n"),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2session-localsettings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-localsettings"}},[t._v("#")]),t._v(" http2session.localSettings")]),t._v(" "),s("ul",[s("li",[t._v("{HTTP/2 Settings Object}")])]),t._v(" "),s("p",[t._v("A prototype-less object describing the current local settings of this\n"),s("code",[t._v("Http2Session")]),t._v(". The local settings are local to "),s("em",[t._v("this")]),t._v(" "),s("code",[t._v("Http2Session")]),t._v(" instance.")]),t._v(" "),s("h4",{attrs:{id:"http2session-originset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-originset"}},[t._v("#")]),t._v(" http2session.originSet")]),t._v(" "),s("ul",[s("li",[t._v("{string[]|undefined}")])]),t._v(" "),s("p",[t._v("If the "),s("code",[t._v("Http2Session")]),t._v(" is connected to a "),s("code",[t._v("TLSSocket")]),t._v(", the "),s("code",[t._v("originSet")]),t._v(" property\nwill return an "),s("code",[t._v("Array")]),t._v(" of origins for which the "),s("code",[t._v("Http2Session")]),t._v(" may be\nconsidered authoritative.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("originSet")]),t._v(" property is only available when using a secure TLS connection.")]),t._v(" "),s("h4",{attrs:{id:"http2session-pendingsettingsack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-pendingsettingsack"}},[t._v("#")]),t._v(" http2session.pendingSettingsAck")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Indicates whether the "),s("code",[t._v("Http2Session")]),t._v(" is currently waiting for acknowledgment of\na sent "),s("code",[t._v("SETTINGS")]),t._v(" frame. Will be "),s("code",[t._v("true")]),t._v(" after calling the\n"),s("code",[t._v("http2session.settings()")]),t._v(" method. Will be "),s("code",[t._v("false")]),t._v(" once all sent "),s("code",[t._v("SETTINGS")]),t._v("\nframes have been acknowledged.")]),t._v(" "),s("h4",{attrs:{id:"http2session-ping-payload-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-ping-payload-callback"}},[t._v("#")]),t._v(" http2session.ping([payload, ]callback)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("payload")]),t._v(" {Buffer|TypedArray|DataView} Optional ping payload.")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")]),t._v(" "),s("li",[t._v("Returns: {boolean}")])]),t._v(" "),s("p",[t._v("Sends a "),s("code",[t._v("PING")]),t._v(" frame to the connected HTTP/2 peer. A "),s("code",[t._v("callback")]),t._v(" function must\nbe provided. The method will return "),s("code",[t._v("true")]),t._v(" if the "),s("code",[t._v("PING")]),t._v(" was sent, "),s("code",[t._v("false")]),t._v("\notherwise.")]),t._v(" "),s("p",[t._v("The maximum number of outstanding (unacknowledged) pings is determined by the\n"),s("code",[t._v("maxOutstandingPings")]),t._v(" configuration option. The default maximum is 10.")]),t._v(" "),s("p",[t._v("If provided, the "),s("code",[t._v("payload")]),t._v(" must be a "),s("code",[t._v("Buffer")]),t._v(", "),s("code",[t._v("TypedArray")]),t._v(", or "),s("code",[t._v("DataView")]),t._v("\ncontaining 8 bytes of data that will be transmitted with the "),s("code",[t._v("PING")]),t._v(" and\nreturned with the ping acknowledgment.")]),t._v(" "),s("p",[t._v("The callback will be invoked with three arguments: an error argument that will\nbe "),s("code",[t._v("null")]),t._v(" if the "),s("code",[t._v("PING")]),t._v(" was successfully acknowledged, a "),s("code",[t._v("duration")]),t._v(" argument\nthat reports the number of milliseconds elapsed since the ping was sent and the\nacknowledgment was received, and a "),s("code",[t._v("Buffer")]),t._v(" containing the 8-byte "),s("code",[t._v("PING")]),t._v("\npayload.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Buffer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'abcdefgh'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" duration"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" payload")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Ping acknowledged in ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("duration"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" milliseconds")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("With payload '")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("payload"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("If the "),s("code",[t._v("payload")]),t._v(" argument is not specified, the default payload will be the\n64-bit timestamp (little endian) marking the start of the "),s("code",[t._v("PING")]),t._v(" duration.")]),t._v(" "),s("h4",{attrs:{id:"http2session-ref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-ref"}},[t._v("#")]),t._v(" http2session.ref()")]),t._v(" "),s("p",[t._v("Calls "),s("router-link",{attrs:{to:"/node/net.html#net_socket_ref"}},[s("code",[t._v("ref()")])]),t._v(" on this "),s("code",[t._v("Http2Session")]),t._v("\ninstance's underlying "),s("router-link",{attrs:{to:"/node/net.html#net_class_net_socket"}},[s("code",[t._v("net.Socket")])]),t._v(".")],1),t._v(" "),s("h4",{attrs:{id:"http2session-remotesettings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-remotesettings"}},[t._v("#")]),t._v(" http2session.remoteSettings")]),t._v(" "),s("ul",[s("li",[t._v("{HTTP/2 Settings Object}")])]),t._v(" "),s("p",[t._v("A prototype-less object describing the current remote settings of this\n"),s("code",[t._v("Http2Session")]),t._v(". The remote settings are set by the "),s("em",[t._v("connected")]),t._v(" HTTP/2 peer.")]),t._v(" "),s("h4",{attrs:{id:"http2session-settimeout-msecs-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-settimeout-msecs-callback"}},[t._v("#")]),t._v(" http2session.setTimeout(msecs, callback)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("msecs")]),t._v(" {number}")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")])]),t._v(" "),s("p",[t._v("Used to set a callback function that is called when there is no activity on\nthe "),s("code",[t._v("Http2Session")]),t._v(" after "),s("code",[t._v("msecs")]),t._v(" milliseconds. The given "),s("code",[t._v("callback")]),t._v(" is\nregistered as a listener on the "),s("code",[t._v("'timeout'")]),t._v(" event.")]),t._v(" "),s("h4",{attrs:{id:"http2session-socket"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-socket"}},[t._v("#")]),t._v(" http2session.socket")]),t._v(" "),s("ul",[s("li",[t._v("{net.Socket|tls.TLSSocket}")])]),t._v(" "),s("p",[t._v("Returns a "),s("code",[t._v("Proxy")]),t._v(" object that acts as a "),s("code",[t._v("net.Socket")]),t._v(" (or "),s("code",[t._v("tls.TLSSocket")]),t._v(") but\nlimits available methods to ones safe to use with HTTP/2.")]),t._v(" "),s("p",[s("code",[t._v("destroy")]),t._v(", "),s("code",[t._v("emit")]),t._v(", "),s("code",[t._v("end")]),t._v(", "),s("code",[t._v("pause")]),t._v(", "),s("code",[t._v("read")]),t._v(", "),s("code",[t._v("resume")]),t._v(", and "),s("code",[t._v("write")]),t._v(" will throw\nan error with code "),s("code",[t._v("ERR_HTTP2_NO_SOCKET_MANIPULATION")]),t._v(". See\n"),s("a",{attrs:{href:"#http2_http2session_and_sockets"}},[s("code",[t._v("Http2Session")]),t._v(" and Sockets")]),t._v(" for more information.")]),t._v(" "),s("p",[s("code",[t._v("setTimeout")]),t._v(" method will be called on this "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("p",[t._v("All other interactions will be routed directly to the socket.")]),t._v(" "),s("h4",{attrs:{id:"http2session-state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-state"}},[t._v("#")]),t._v(" http2session.state")]),t._v(" "),s("p",[t._v("Provides miscellaneous information about the current state of the\n"),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("ul",[s("li",[t._v("{Object}\n"),s("ul",[s("li",[s("code",[t._v("effectiveLocalWindowSize")]),t._v(" {number} The current local (receive)\nflow control window size for the "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("effectiveRecvDataLength")]),t._v(" {number} The current number of bytes\nthat have been received since the last flow control "),s("code",[t._v("WINDOW_UPDATE")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("nextStreamID")]),t._v(" {number} The numeric identifier to be used the\nnext time a new "),s("code",[t._v("Http2Stream")]),t._v(" is created by this "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("localWindowSize")]),t._v(" {number} The number of bytes that the remote peer can\nsend without receiving a "),s("code",[t._v("WINDOW_UPDATE")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("lastProcStreamID")]),t._v(" {number} The numeric id of the "),s("code",[t._v("Http2Stream")]),t._v("\nfor which a "),s("code",[t._v("HEADERS")]),t._v(" or "),s("code",[t._v("DATA")]),t._v(" frame was most recently received.")]),t._v(" "),s("li",[s("code",[t._v("remoteWindowSize")]),t._v(" {number} The number of bytes that this "),s("code",[t._v("Http2Session")]),t._v("\nmay send without receiving a "),s("code",[t._v("WINDOW_UPDATE")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("outboundQueueSize")]),t._v(" {number} The number of frames currently within the\noutbound queue for this "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("deflateDynamicTableSize")]),t._v(" {number} The current size in bytes of the\noutbound header compression state table.")]),t._v(" "),s("li",[s("code",[t._v("inflateDynamicTableSize")]),t._v(" {number} The current size in bytes of the\ninbound header compression state table.")])])])]),t._v(" "),s("p",[t._v("An object describing the current status of this "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2session-settings-settings-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-settings-settings-callback"}},[t._v("#")]),t._v(" http2session.settings([settings][, callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("settings")]),t._v(" {HTTP/2 Settings Object}")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function} Callback that is called once the session is connected or\nright away if the session is already connected.\n"),s("ul",[s("li",[s("code",[t._v("err")]),t._v(" {Error|null}")]),t._v(" "),s("li",[s("code",[t._v("settings")]),t._v(" {HTTP/2 Settings Object} The updated "),s("code",[t._v("settings")]),t._v(" object.")]),t._v(" "),s("li",[s("code",[t._v("duration")]),t._v(" {integer}")])])])]),t._v(" "),s("p",[t._v("Updates the current local settings for this "),s("code",[t._v("Http2Session")]),t._v(" and sends a new\n"),s("code",[t._v("SETTINGS")]),t._v(" frame to the connected HTTP/2 peer.")]),t._v(" "),s("p",[t._v("Once called, the "),s("code",[t._v("http2session.pendingSettingsAck")]),t._v(" property will be "),s("code",[t._v("true")]),t._v("\nwhile the session is waiting for the remote peer to acknowledge the new\nsettings.")]),t._v(" "),s("p",[t._v("The new settings will not become effective until the "),s("code",[t._v("SETTINGS")]),t._v(" acknowledgment\nis received and the "),s("code",[t._v("'localSettings'")]),t._v(" event is emitted. It is possible to send\nmultiple "),s("code",[t._v("SETTINGS")]),t._v(" frames while acknowledgment is still pending.")]),t._v(" "),s("h4",{attrs:{id:"http2session-type"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-type"}},[t._v("#")]),t._v(" http2session.type")]),t._v(" "),s("ul",[s("li",[t._v("{number}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("http2session.type")]),t._v(" will be equal to\n"),s("code",[t._v("http2.constants.NGHTTP2_SESSION_SERVER")]),t._v(" if this "),s("code",[t._v("Http2Session")]),t._v(" instance is a\nserver, and "),s("code",[t._v("http2.constants.NGHTTP2_SESSION_CLIENT")]),t._v(" if the instance is a\nclient.")]),t._v(" "),s("h4",{attrs:{id:"http2session-unref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2session-unref"}},[t._v("#")]),t._v(" http2session.unref()")]),t._v(" "),s("p",[t._v("Calls "),s("router-link",{attrs:{to:"/node/net.html#net_socket_unref"}},[s("code",[t._v("unref()")])]),t._v(" on this "),s("code",[t._v("Http2Session")]),t._v("\ninstance's underlying "),s("router-link",{attrs:{to:"/node/net.html#net_class_net_socket"}},[s("code",[t._v("net.Socket")])]),t._v(".")],1),t._v(" "),s("h3",{attrs:{id:"class-serverhttp2session"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-serverhttp2session"}},[t._v("#")]),t._v(" Class: ServerHttp2Session")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {Http2Session}")])]),t._v(" "),s("h4",{attrs:{id:"serverhttp2session-altsvc-alt-originorstream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#serverhttp2session-altsvc-alt-originorstream"}},[t._v("#")]),t._v(" serverhttp2session.altsvc(alt, originOrStream)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("alt")]),t._v(" {string} A description of the alternative service configuration as\ndefined by "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc7838",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 7838"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("originOrStream")]),t._v(" {number|string|URL|Object} Either a URL string specifying\nthe origin (or an "),s("code",[t._v("Object")]),t._v(" with an "),s("code",[t._v("origin")]),t._v(" property) or the numeric\nidentifier of an active "),s("code",[t._v("Http2Stream")]),t._v(" as given by the "),s("code",[t._v("http2stream.id")]),t._v("\nproperty.")])]),t._v(" "),s("p",[t._v("Submits an "),s("code",[t._v("ALTSVC")]),t._v(" frame (as defined by "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc7838",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 7838"),s("OutboundLink")],1),t._v(") to the connected client.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'session'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("session")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set altsvc for origin https://example.org:80")]),t._v("\n  session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("altsvc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h2=\":8000\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.org:80'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set altsvc for a specific stream")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("altsvc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h2=\":8000\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Sending an "),s("code",[t._v("ALTSVC")]),t._v(" frame with a specific stream ID indicates that the alternate\nservice is associated with the origin of the given "),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("alt")]),t._v(" and origin string "),s("em",[t._v("must")]),t._v(" contain only ASCII bytes and are\nstrictly interpreted as a sequence of ASCII bytes. The special value "),s("code",[t._v("'clear'")]),t._v("\nmay be passed to clear any previously set alternative service for a given\ndomain.")]),t._v(" "),s("p",[t._v("When a string is passed for the "),s("code",[t._v("originOrStream")]),t._v(" argument, it will be parsed as\na URL and the origin will be derived. For instance, the origin for the\nHTTP URL "),s("code",[t._v("'https://example.org/foo/bar'")]),t._v(" is the ASCII string\n"),s("code",[t._v("'https://example.org'")]),t._v(". An error will be thrown if either the given string\ncannot be parsed as a URL or if a valid origin cannot be derived.")]),t._v(" "),s("p",[t._v("A "),s("code",[t._v("URL")]),t._v(" object, or any object with an "),s("code",[t._v("origin")]),t._v(" property, may be passed as\n"),s("code",[t._v("originOrStream")]),t._v(", in which case the value of the "),s("code",[t._v("origin")]),t._v(" property will be\nused. The value of the "),s("code",[t._v("origin")]),t._v(" property "),s("em",[t._v("must")]),t._v(" be a properly serialized\nASCII origin.")]),t._v(" "),s("h4",{attrs:{id:"specifying-alternative-services"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specifying-alternative-services"}},[t._v("#")]),t._v(" Specifying alternative services")]),t._v(" "),s("p",[t._v("The format of the "),s("code",[t._v("alt")]),t._v(" parameter is strictly defined by "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc7838",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 7838"),s("OutboundLink")],1),t._v(' as an\nASCII string containing a comma-delimited list of "alternative" protocols\nassociated with a specific host and port.')]),t._v(" "),s("p",[t._v("For example, the value "),s("code",[t._v("'h2=\"example.org:81\"'")]),t._v(" indicates that the HTTP/2\nprotocol is available on the host "),s("code",[t._v("'example.org'")]),t._v(" on TCP/IP port 81. The\nhost and port "),s("em",[t._v("must")]),t._v(" be contained within the quote ("),s("code",[t._v('"')]),t._v(") characters.")]),t._v(" "),s("p",[t._v("Multiple alternatives may be specified, for instance: "),s("code",[t._v('\'h2="example.org:81", h2=":82"\'')]),t._v(".")]),t._v(" "),s("p",[t._v("The protocol identifier ("),s("code",[t._v("'h2'")]),t._v(" in the examples) may be any valid\n"),s("a",{attrs:{href:"https://www.iana.org/assignments/tls-extensiontype-values/tls-extensiontype-values.xhtml#alpn-protocol-ids",target:"_blank",rel:"noopener noreferrer"}},[t._v("ALPN Protocol ID"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("The syntax of these values is not validated by the Node.js implementation and\nare passed through as provided by the user or received from the peer.")]),t._v(" "),s("h4",{attrs:{id:"serverhttp2session-origin-origins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#serverhttp2session-origin-origins"}},[t._v("#")]),t._v(" serverhttp2session.origin(...origins)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("origins")]),t._v(" { string | URL | Object } One or more URL Strings passed as\nseparate arguments.")])]),t._v(" "),s("p",[t._v("Submits an "),s("code",[t._v("ORIGIN")]),t._v(" frame (as defined by "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc8336",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 8336"),s("OutboundLink")],1),t._v(") to the connected client\nto advertise the set of origins for which the server is capable of providing\nauthoritative responses.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSecureOptionsSomehow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createSecureServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'session'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("session")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("origin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.org'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("When a string is passed as an "),s("code",[t._v("origin")]),t._v(", it will be parsed as a URL and the\norigin will be derived. For instance, the origin for the HTTP URL\n"),s("code",[t._v("'https://example.org/foo/bar'")]),t._v(" is the ASCII string\n"),s("code",[t._v("'https://example.org'")]),t._v(". An error will be thrown if either the given string\ncannot be parsed as a URL or if a valid origin cannot be derived.")]),t._v(" "),s("p",[t._v("A "),s("code",[t._v("URL")]),t._v(" object, or any object with an "),s("code",[t._v("origin")]),t._v(" property, may be passed as\nan "),s("code",[t._v("origin")]),t._v(", in which case the value of the "),s("code",[t._v("origin")]),t._v(" property will be\nused. The value of the "),s("code",[t._v("origin")]),t._v(" property "),s("em",[t._v("must")]),t._v(" be a properly serialized\nASCII origin.")]),t._v(" "),s("p",[t._v("Alternatively, the "),s("code",[t._v("origins")]),t._v(" option may be used when creating a new HTTP/2\nserver using the "),s("code",[t._v("http2.createSecureServer()")]),t._v(" method:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSecureOptionsSomehow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\noptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origins "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.org'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createSecureServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"class-clienthttp2session"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-clienthttp2session"}},[t._v("#")]),t._v(" Class: ClientHttp2Session")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {Http2Session}")])]),t._v(" "),s("h4",{attrs:{id:"event-altsvc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-altsvc"}},[t._v("#")]),t._v(" Event: 'altsvc'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("alt")]),t._v(" {string}")]),t._v(" "),s("li",[s("code",[t._v("origin")]),t._v(" {string}")]),t._v(" "),s("li",[s("code",[t._v("streamId")]),t._v(" {number}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'altsvc'")]),t._v(" event is emitted whenever an "),s("code",[t._v("ALTSVC")]),t._v(" frame is received by\nthe client. The event is emitted with the "),s("code",[t._v("ALTSVC")]),t._v(" value, origin, and stream\nID. If no "),s("code",[t._v("origin")]),t._v(" is provided in the "),s("code",[t._v("ALTSVC")]),t._v(" frame, "),s("code",[t._v("origin")]),t._v(" will\nbe an empty string.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.org'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nclient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'altsvc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("alt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" origin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" streamId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("alt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("origin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("streamId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"event-origin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-origin"}},[t._v("#")]),t._v(" Event: 'origin'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("origins")]),t._v(" {string[]}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'origin'")]),t._v(" event is emitted whenever an "),s("code",[t._v("ORIGIN")]),t._v(" frame is received by\nthe client. The event is emitted with an array of "),s("code",[t._v("origin")]),t._v(" strings. The\n"),s("code",[t._v("http2session.originSet")]),t._v(" will be updated to include the received\norigins.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.org'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nclient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'origin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("origins")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" origins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("origins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("The "),s("code",[t._v("'origin'")]),t._v(" event is only emitted when using a secure TLS connection.")]),t._v(" "),s("h4",{attrs:{id:"clienthttp2session-request-headers-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#clienthttp2session-request-headers-options"}},[t._v("#")]),t._v(" clienthttp2session.request(headers[, options])")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object}")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("options")]),t._v(" {Object}")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("endStream")]),t._v(" {boolean} "),s("code",[t._v("true")]),t._v(" if the "),s("code",[t._v("Http2Stream")]),t._v(" "),s("em",[t._v("writable")]),t._v(" side should\nbe closed initially, such as when sending a "),s("code",[t._v("GET")]),t._v(" request that should not\nexpect a payload body.")]),t._v(" "),s("li",[s("code",[t._v("exclusive")]),t._v(" {boolean} When "),s("code",[t._v("true")]),t._v(" and "),s("code",[t._v("parent")]),t._v(" identifies a parent Stream,\nthe created stream is made the sole direct dependency of the parent, with\nall other existing dependents made a dependent of the newly created stream.\n"),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("false")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("parent")]),t._v(" {number} Specifies the numeric identifier of a stream the newly\ncreated stream is dependent on.")]),t._v(" "),s("li",[s("code",[t._v("weight")]),t._v(" {number} Specifies the relative dependency of a stream in relation\nto other streams with the same "),s("code",[t._v("parent")]),t._v(". The value is a number between "),s("code",[t._v("1")]),t._v("\nand "),s("code",[t._v("256")]),t._v(" (inclusive).")]),t._v(" "),s("li",[s("code",[t._v("waitForTrailers")]),t._v(" {boolean} When "),s("code",[t._v("true")]),t._v(", the "),s("code",[t._v("Http2Stream")]),t._v(" will emit the\n"),s("code",[t._v("'wantTrailers'")]),t._v(" event after the final "),s("code",[t._v("DATA")]),t._v(" frame has been sent.")])])]),t._v(" "),s("li",[s("p",[t._v("Returns: {ClientHttp2Stream}")])])]),t._v(" "),s("p",[t._v("For HTTP/2 Client "),s("code",[t._v("Http2Session")]),t._v(" instances only, the "),s("code",[t._v("http2session.request()")]),t._v("\ncreates and returns an "),s("code",[t._v("Http2Stream")]),t._v(" instance that can be used to send an\nHTTP/2 request to the connected server.")]),t._v(" "),s("p",[t._v("This method is only available if "),s("code",[t._v("http2session.type")]),t._v(" is equal to\n"),s("code",[t._v("http2.constants.NGHTTP2_SESSION_CLIENT")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" clientSession "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://localhost:1234'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_PATH")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_STATUS")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constants"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" req "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" clientSession"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_PATH")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'response'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_STATUS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* .. */")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* .. */")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("When the "),s("code",[t._v("options.waitForTrailers")]),t._v(" option is set, the "),s("code",[t._v("'wantTrailers'")]),t._v(" event\nis emitted immediately after queuing the last chunk of payload data to be sent.\nThe "),s("code",[t._v("http2stream.sendTrailers()")]),t._v(" method can then be called to send trailing\nheaders to the peer.")]),t._v(" "),s("p",[t._v("When "),s("code",[t._v("options.waitForTrailers")]),t._v(" is set, the "),s("code",[t._v("Http2Stream")]),t._v(" will not automatically\nclose when the final "),s("code",[t._v("DATA")]),t._v(" frame is transmitted. User code must call either\n"),s("code",[t._v("http2stream.sendTrailers()")]),t._v(" or "),s("code",[t._v("http2stream.close()")]),t._v(" to close the\n"),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v(":method")]),t._v(" and "),s("code",[t._v(":path")]),t._v(" pseudo-headers are not specified within "),s("code",[t._v("headers")]),t._v(",\nthey respectively default to:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v(":method")]),t._v(" = "),s("code",[t._v("'GET'")])]),t._v(" "),s("li",[s("code",[t._v(":path")]),t._v(" = "),s("code",[t._v("/")])])]),t._v(" "),s("h3",{attrs:{id:"class-http2stream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-http2stream"}},[t._v("#")]),t._v(" Class: Http2Stream")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {stream.Duplex}")])]),t._v(" "),s("p",[t._v("Each instance of the "),s("code",[t._v("Http2Stream")]),t._v(" class represents a bidirectional HTTP/2\ncommunications stream over an "),s("code",[t._v("Http2Session")]),t._v(" instance. Any single "),s("code",[t._v("Http2Session")]),t._v("\nmay have up to 2"),s("sup",[t._v("31")]),t._v("-1 "),s("code",[t._v("Http2Stream")]),t._v(" instances over its lifetime.")]),t._v(" "),s("p",[t._v("User code will not construct "),s("code",[t._v("Http2Stream")]),t._v(" instances directly. Rather, these\nare created, managed, and provided to user code through the "),s("code",[t._v("Http2Session")]),t._v("\ninstance. On the server, "),s("code",[t._v("Http2Stream")]),t._v(" instances are created either in response\nto an incoming HTTP request (and handed off to user code via the "),s("code",[t._v("'stream'")]),t._v("\nevent), or in response to a call to the "),s("code",[t._v("http2stream.pushStream()")]),t._v(" method.\nOn the client, "),s("code",[t._v("Http2Stream")]),t._v(" instances are created and returned when either the\n"),s("code",[t._v("http2session.request()")]),t._v(" method is called, or in response to an incoming\n"),s("code",[t._v("'push'")]),t._v(" event.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("Http2Stream")]),t._v(" class is a base for the "),s("a",{attrs:{href:"#http2_class_serverhttp2stream"}},[s("code",[t._v("ServerHttp2Stream")])]),t._v(" and\n"),s("a",{attrs:{href:"#http2_class_clienthttp2stream"}},[s("code",[t._v("ClientHttp2Stream")])]),t._v(" classes, each of which is used specifically by either\nthe Server or Client side, respectively.")]),t._v(" "),s("p",[t._v("All "),s("code",[t._v("Http2Stream")]),t._v(" instances are "),s("router-link",{attrs:{to:"/node/stream.html#stream_class_stream_duplex"}},[s("code",[t._v("Duplex")])]),t._v(" streams. The "),s("code",[t._v("Writable")]),t._v(" side of the\n"),s("code",[t._v("Duplex")]),t._v(" is used to send data to the connected peer, while the "),s("code",[t._v("Readable")]),t._v(" side\nis used to receive data sent by the connected peer.")],1),t._v(" "),s("h4",{attrs:{id:"http2stream-lifecycle"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-lifecycle"}},[t._v("#")]),t._v(" Http2Stream Lifecycle")]),t._v(" "),s("h5",{attrs:{id:"creation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creation"}},[t._v("#")]),t._v(" Creation")]),t._v(" "),s("p",[t._v("On the server side, instances of "),s("a",{attrs:{href:"#http2_class_serverhttp2stream"}},[s("code",[t._v("ServerHttp2Stream")])]),t._v(" are created either\nwhen:")]),t._v(" "),s("ul",[s("li",[t._v("A new HTTP/2 "),s("code",[t._v("HEADERS")]),t._v(" frame with a previously unused stream ID is received;")]),t._v(" "),s("li",[t._v("The "),s("code",[t._v("http2stream.pushStream()")]),t._v(" method is called.")])]),t._v(" "),s("p",[t._v("On the client side, instances of "),s("a",{attrs:{href:"#http2_class_clienthttp2stream"}},[s("code",[t._v("ClientHttp2Stream")])]),t._v(" are created when the\n"),s("code",[t._v("http2session.request()")]),t._v(" method is called.")]),t._v(" "),s("p",[t._v("On the client, the "),s("code",[t._v("Http2Stream")]),t._v(" instance returned by "),s("code",[t._v("http2session.request()")]),t._v("\nmay not be immediately ready for use if the parent "),s("code",[t._v("Http2Session")]),t._v(" has not yet\nbeen fully established. In such cases, operations called on the "),s("code",[t._v("Http2Stream")]),t._v("\nwill be buffered until the "),s("code",[t._v("'ready'")]),t._v(" event is emitted. User code should rarely,\nif ever, need to handle the "),s("code",[t._v("'ready'")]),t._v(" event directly. The ready status of an\n"),s("code",[t._v("Http2Stream")]),t._v(" can be determined by checking the value of "),s("code",[t._v("http2stream.id")]),t._v(". If\nthe value is "),s("code",[t._v("undefined")]),t._v(", the stream is not yet ready for use.")]),t._v(" "),s("h5",{attrs:{id:"destruction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#destruction"}},[t._v("#")]),t._v(" Destruction")]),t._v(" "),s("p",[t._v("All "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v(" instances are destroyed either when:")]),t._v(" "),s("ul",[s("li",[t._v("An "),s("code",[t._v("RST_STREAM")]),t._v(" frame for the stream is received by the connected peer,\nand pending data has been read.")]),t._v(" "),s("li",[t._v("The "),s("code",[t._v("http2stream.close()")]),t._v(" method is called, and pending data has been read.")]),t._v(" "),s("li",[t._v("The "),s("code",[t._v("http2stream.destroy()")]),t._v(" or "),s("code",[t._v("http2session.destroy()")]),t._v(" methods are called.")])]),t._v(" "),s("p",[t._v("When an "),s("code",[t._v("Http2Stream")]),t._v(" instance is destroyed, an attempt will be made to send an\n"),s("code",[t._v("RST_STREAM")]),t._v(" frame to the connected peer.")]),t._v(" "),s("p",[t._v("When the "),s("code",[t._v("Http2Stream")]),t._v(" instance is destroyed, the "),s("code",[t._v("'close'")]),t._v(" event will\nbe emitted. Because "),s("code",[t._v("Http2Stream")]),t._v(" is an instance of "),s("code",[t._v("stream.Duplex")]),t._v(", the\n"),s("code",[t._v("'end'")]),t._v(" event will also be emitted if the stream data is currently flowing.\nThe "),s("code",[t._v("'error'")]),t._v(" event may also be emitted if "),s("code",[t._v("http2stream.destroy()")]),t._v(" was called\nwith an "),s("code",[t._v("Error")]),t._v(" passed as the first argument.")]),t._v(" "),s("p",[t._v("After the "),s("code",[t._v("Http2Stream")]),t._v(" has been destroyed, the "),s("code",[t._v("http2stream.destroyed")]),t._v("\nproperty will be "),s("code",[t._v("true")]),t._v(" and the "),s("code",[t._v("http2stream.rstCode")]),t._v(" property will specify the\n"),s("code",[t._v("RST_STREAM")]),t._v(" error code. The "),s("code",[t._v("Http2Stream")]),t._v(" instance is no longer usable once\ndestroyed.")]),t._v(" "),s("h4",{attrs:{id:"event-aborted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-aborted"}},[t._v("#")]),t._v(" Event: 'aborted'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'aborted'")]),t._v(" event is emitted whenever a "),s("code",[t._v("Http2Stream")]),t._v(" instance is\nabnormally aborted in mid-communication.\nIts listener does not expect any arguments.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'aborted'")]),t._v(" event will only be emitted if the "),s("code",[t._v("Http2Stream")]),t._v(" writable side\nhas not been ended.")]),t._v(" "),s("h4",{attrs:{id:"event-close-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-close-2"}},[t._v("#")]),t._v(" Event: 'close'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'close'")]),t._v(" event is emitted when the "),s("code",[t._v("Http2Stream")]),t._v(" is destroyed. Once\nthis event is emitted, the "),s("code",[t._v("Http2Stream")]),t._v(" instance is no longer usable.")]),t._v(" "),s("p",[t._v("The HTTP/2 error code used when closing the stream can be retrieved using\nthe "),s("code",[t._v("http2stream.rstCode")]),t._v(" property. If the code is any value other than\n"),s("code",[t._v("NGHTTP2_NO_ERROR")]),t._v(" ("),s("code",[t._v("0")]),t._v("), an "),s("code",[t._v("'error'")]),t._v(" event will have also been emitted.")]),t._v(" "),s("h4",{attrs:{id:"event-error-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-error-2"}},[t._v("#")]),t._v(" Event: 'error'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("error")]),t._v(" {Error}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'error'")]),t._v(" event is emitted when an error occurs during the processing of\nan "),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-frameerror-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-frameerror-2"}},[t._v("#")]),t._v(" Event: 'frameError'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'frameError'")]),t._v(" event is emitted when an error occurs while attempting to\nsend a frame. When invoked, the handler function will receive an integer\nargument identifying the frame type, and an integer argument identifying the\nerror code. The "),s("code",[t._v("Http2Stream")]),t._v(" instance will be destroyed immediately after the\n"),s("code",[t._v("'frameError'")]),t._v(" event is emitted.")]),t._v(" "),s("h4",{attrs:{id:"event-timeout-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-timeout-2"}},[t._v("#")]),t._v(" Event: 'timeout'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'timeout'")]),t._v(" event is emitted after no activity is received for this\n"),s("code",[t._v("Http2Stream")]),t._v(" within the number of milliseconds set using\n"),s("code",[t._v("http2stream.setTimeout()")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-trailers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-trailers"}},[t._v("#")]),t._v(" Event: 'trailers'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'trailers'")]),t._v(" event is emitted when a block of headers associated with\ntrailing header fields is received. The listener callback is passed the\n"),s("a",{attrs:{href:"#http2_headers_object"}},[t._v("HTTP/2 Headers Object")]),t._v(" and flags associated with the headers.")]),t._v(" "),s("p",[t._v("This event might not be emitted if "),s("code",[t._v("http2stream.end()")]),t._v(" is called\nbefore trailers are received and the incoming data is not being read or\nlistened for.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'trailers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"event-wanttrailers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-wanttrailers"}},[t._v("#")]),t._v(" Event: 'wantTrailers'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'wantTrailers'")]),t._v(" event is emitted when the "),s("code",[t._v("Http2Stream")]),t._v(" has queued the\nfinal "),s("code",[t._v("DATA")]),t._v(" frame to be sent on a frame and the "),s("code",[t._v("Http2Stream")]),t._v(" is ready to send\ntrailing headers. When initiating a request or response, the "),s("code",[t._v("waitForTrailers")]),t._v("\noption must be set for this event to be emitted.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-aborted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-aborted"}},[t._v("#")]),t._v(" http2stream.aborted")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Set to "),s("code",[t._v("true")]),t._v(" if the "),s("code",[t._v("Http2Stream")]),t._v(" instance was aborted abnormally. When set,\nthe "),s("code",[t._v("'aborted'")]),t._v(" event will have been emitted.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-buffersize"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-buffersize"}},[t._v("#")]),t._v(" http2stream.bufferSize")]),t._v(" "),s("ul",[s("li",[t._v("{number}")])]),t._v(" "),s("p",[t._v("This property shows the number of characters currently buffered to be written.\nSee "),s("router-link",{attrs:{to:"/node/net.html#net_socket_buffersize"}},[s("code",[t._v("net.Socket.bufferSize")])]),t._v(" for details.")],1),t._v(" "),s("h4",{attrs:{id:"http2stream-close-code-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-close-code-callback"}},[t._v("#")]),t._v(" http2stream.close(code[, callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("code")]),t._v(" {number} Unsigned 32-bit integer identifying the error code.\n"),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("http2.constants.NGHTTP2_NO_ERROR")]),t._v(" ("),s("code",[t._v("0x00")]),t._v(").")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function} An optional function registered to listen for the\n"),s("code",[t._v("'close'")]),t._v(" event.")])]),t._v(" "),s("p",[t._v("Closes the "),s("code",[t._v("Http2Stream")]),t._v(" instance by sending an "),s("code",[t._v("RST_STREAM")]),t._v(" frame to the\nconnected HTTP/2 peer.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-closed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-closed"}},[t._v("#")]),t._v(" http2stream.closed")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Set to "),s("code",[t._v("true")]),t._v(" if the "),s("code",[t._v("Http2Stream")]),t._v(" instance has been closed.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-destroyed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-destroyed"}},[t._v("#")]),t._v(" http2stream.destroyed")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Set to "),s("code",[t._v("true")]),t._v(" if the "),s("code",[t._v("Http2Stream")]),t._v(" instance has been destroyed and is no longer\nusable.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-endafterheaders"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-endafterheaders"}},[t._v("#")]),t._v(" http2stream.endAfterHeaders")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Set the "),s("code",[t._v("true")]),t._v(" if the "),s("code",[t._v("END_STREAM")]),t._v(" flag was set in the request or response\nHEADERS frame received, indicating that no additional data should be received\nand the readable side of the "),s("code",[t._v("Http2Stream")]),t._v(" will be closed.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-id"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-id"}},[t._v("#")]),t._v(" http2stream.id")]),t._v(" "),s("ul",[s("li",[t._v("{number|undefined}")])]),t._v(" "),s("p",[t._v("The numeric stream identifier of this "),s("code",[t._v("Http2Stream")]),t._v(" instance. Set to "),s("code",[t._v("undefined")]),t._v("\nif the stream identifier has not yet been assigned.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-pending"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-pending"}},[t._v("#")]),t._v(" http2stream.pending")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Set to "),s("code",[t._v("true")]),t._v(" if the "),s("code",[t._v("Http2Stream")]),t._v(" instance has not yet been assigned a\nnumeric stream identifier.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-priority-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-priority-options"}},[t._v("#")]),t._v(" http2stream.priority(options)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("options")]),t._v(" {Object}\n"),s("ul",[s("li",[s("code",[t._v("exclusive")]),t._v(" {boolean} When "),s("code",[t._v("true")]),t._v(" and "),s("code",[t._v("parent")]),t._v(" identifies a parent Stream,\nthis stream is made the sole direct dependency of the parent, with\nall other existing dependents made a dependent of this stream. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("false")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("parent")]),t._v(" {number} Specifies the numeric identifier of a stream this stream\nis dependent on.")]),t._v(" "),s("li",[s("code",[t._v("weight")]),t._v(" {number} Specifies the relative dependency of a stream in relation\nto other streams with the same "),s("code",[t._v("parent")]),t._v(". The value is a number between "),s("code",[t._v("1")]),t._v("\nand "),s("code",[t._v("256")]),t._v(" (inclusive).")]),t._v(" "),s("li",[s("code",[t._v("silent")]),t._v(" {boolean} When "),s("code",[t._v("true")]),t._v(", changes the priority locally without\nsending a "),s("code",[t._v("PRIORITY")]),t._v(" frame to the connected peer.")])])])]),t._v(" "),s("p",[t._v("Updates the priority for this "),s("code",[t._v("Http2Stream")]),t._v(" instance.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-rstcode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-rstcode"}},[t._v("#")]),t._v(" http2stream.rstCode")]),t._v(" "),s("ul",[s("li",[t._v("{number}")])]),t._v(" "),s("p",[t._v("Set to the "),s("code",[t._v("RST_STREAM")]),t._v(" "),s("a",{attrs:{href:"#error_codes"}},[t._v("error code")]),t._v(" reported when the "),s("code",[t._v("Http2Stream")]),t._v(" is\ndestroyed after either receiving an "),s("code",[t._v("RST_STREAM")]),t._v(" frame from the connected peer,\ncalling "),s("code",[t._v("http2stream.close()")]),t._v(", or "),s("code",[t._v("http2stream.destroy()")]),t._v(". Will be\n"),s("code",[t._v("undefined")]),t._v(" if the "),s("code",[t._v("Http2Stream")]),t._v(" has not been closed.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-sentheaders"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-sentheaders"}},[t._v("#")]),t._v(" http2stream.sentHeaders")]),t._v(" "),s("ul",[s("li",[t._v("{HTTP/2 Headers Object}")])]),t._v(" "),s("p",[t._v("An object containing the outbound headers sent for this "),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2stream-sentinfoheaders"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-sentinfoheaders"}},[t._v("#")]),t._v(" http2stream.sentInfoHeaders")]),t._v(" "),s("ul",[s("li",[t._v("{HTTP/2 Headers Object[]}")])]),t._v(" "),s("p",[t._v("An array of objects containing the outbound informational (additional) headers\nsent for this "),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2stream-senttrailers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-senttrailers"}},[t._v("#")]),t._v(" http2stream.sentTrailers")]),t._v(" "),s("ul",[s("li",[t._v("{HTTP/2 Headers Object}")])]),t._v(" "),s("p",[t._v("An object containing the outbound trailers sent for this "),s("code",[t._v("HttpStream")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2stream-session"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-session"}},[t._v("#")]),t._v(" http2stream.session")]),t._v(" "),s("ul",[s("li",[t._v("{Http2Session}")])]),t._v(" "),s("p",[t._v("A reference to the "),s("code",[t._v("Http2Session")]),t._v(" instance that owns this "),s("code",[t._v("Http2Stream")]),t._v(". The\nvalue will be "),s("code",[t._v("undefined")]),t._v(" after the "),s("code",[t._v("Http2Stream")]),t._v(" instance is destroyed.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-settimeout-msecs-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-settimeout-msecs-callback"}},[t._v("#")]),t._v(" http2stream.setTimeout(msecs, callback)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("msecs")]),t._v(" {number}")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://example.org:8000'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NGHTTP2_CANCEL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constants"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" req "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Cancel the stream if there's no activity after 5 seconds")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NGHTTP2_CANCEL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"http2stream-state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-state"}},[t._v("#")]),t._v(" http2stream.state")]),t._v(" "),s("p",[t._v("Provides miscellaneous information about the current state of the\n"),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("ul",[s("li",[t._v("{Object}\n"),s("ul",[s("li",[s("code",[t._v("localWindowSize")]),t._v(" {number} The number of bytes the connected peer may send\nfor this "),s("code",[t._v("Http2Stream")]),t._v(" without receiving a "),s("code",[t._v("WINDOW_UPDATE")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("state")]),t._v(" {number} A flag indicating the low-level current state of the\n"),s("code",[t._v("Http2Stream")]),t._v(" as determined by "),s("code",[t._v("nghttp2")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("localClose")]),t._v(" {number} "),s("code",[t._v("1")]),t._v(" if this "),s("code",[t._v("Http2Stream")]),t._v(" has been closed locally.")]),t._v(" "),s("li",[s("code",[t._v("remoteClose")]),t._v(" {number} "),s("code",[t._v("1")]),t._v(" if this "),s("code",[t._v("Http2Stream")]),t._v(" has been closed\nremotely.")]),t._v(" "),s("li",[s("code",[t._v("sumDependencyWeight")]),t._v(" {number} The sum weight of all "),s("code",[t._v("Http2Stream")]),t._v("\ninstances that depend on this "),s("code",[t._v("Http2Stream")]),t._v(" as specified using\n"),s("code",[t._v("PRIORITY")]),t._v(" frames.")]),t._v(" "),s("li",[s("code",[t._v("weight")]),t._v(" {number} The priority weight of this "),s("code",[t._v("Http2Stream")]),t._v(".")])])])]),t._v(" "),s("p",[t._v("A current state of this "),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2stream-sendtrailers-headers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-sendtrailers-headers"}},[t._v("#")]),t._v(" http2stream.sendTrailers(headers)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object}")])]),t._v(" "),s("p",[t._v("Sends a trailing "),s("code",[t._v("HEADERS")]),t._v(" frame to the connected HTTP/2 peer. This method\nwill cause the "),s("code",[t._v("Http2Stream")]),t._v(" to be immediately closed and must only be\ncalled after the "),s("code",[t._v("'wantTrailers'")]),t._v(" event has been emitted. When sending a\nrequest or sending a response, the "),s("code",[t._v("options.waitForTrailers")]),t._v(" option must be set\nin order to keep the "),s("code",[t._v("Http2Stream")]),t._v(" open after the final "),s("code",[t._v("DATA")]),t._v(" frame so that\ntrailers can be sent.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" waitForTrailers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wantTrailers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendTrailers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" xyz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'abc'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello World'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("The HTTP/1 specification forbids trailers from containing HTTP/2 pseudo-header\nfields (e.g. "),s("code",[t._v("':method'")]),t._v(", "),s("code",[t._v("':path'")]),t._v(", etc).")]),t._v(" "),s("h3",{attrs:{id:"class-clienthttp2stream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-clienthttp2stream"}},[t._v("#")]),t._v(" Class: ClientHttp2Stream")]),t._v(" "),s("ul",[s("li",[t._v("Extends {Http2Stream}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("ClientHttp2Stream")]),t._v(" class is an extension of "),s("code",[t._v("Http2Stream")]),t._v(" that is\nused exclusively on HTTP/2 Clients. "),s("code",[t._v("Http2Stream")]),t._v(" instances on the client\nprovide events such as "),s("code",[t._v("'response'")]),t._v(" and "),s("code",[t._v("'push'")]),t._v(" that are only relevant on\nthe client.")]),t._v(" "),s("h4",{attrs:{id:"event-continue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-continue"}},[t._v("#")]),t._v(" Event: 'continue'")]),t._v(" "),s("p",[t._v("Emitted when the server sends a "),s("code",[t._v("100 Continue")]),t._v(" status, usually because\nthe request contained "),s("code",[t._v("Expect: 100-continue")]),t._v(". This is an instruction that\nthe client should send the request body.")]),t._v(" "),s("h4",{attrs:{id:"event-headers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-headers"}},[t._v("#")]),t._v(" Event: 'headers'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'headers'")]),t._v(" event is emitted when an additional block of headers is received\nfor a stream, such as when a block of "),s("code",[t._v("1xx")]),t._v(" informational headers is received.\nThe listener callback is passed the "),s("a",{attrs:{href:"#http2_headers_object"}},[t._v("HTTP/2 Headers Object")]),t._v(" and flags\nassociated with the headers.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'headers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"event-push"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-push"}},[t._v("#")]),t._v(" Event: 'push'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'push'")]),t._v(" event is emitted when response headers for a Server Push stream\nare received. The listener callback is passed the "),s("a",{attrs:{href:"#http2_headers_object"}},[t._v("HTTP/2 Headers Object")]),t._v(" and\nflags associated with the headers.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'push'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"event-response"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-response"}},[t._v("#")]),t._v(" Event: 'response'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'response'")]),t._v(" event is emitted when a response "),s("code",[t._v("HEADERS")]),t._v(" frame has been\nreceived for this stream from the connected HTTP/2 server. The listener is\ninvoked with two arguments: an "),s("code",[t._v("Object")]),t._v(" containing the received\n"),s("a",{attrs:{href:"#http2_headers_object"}},[t._v("HTTP/2 Headers Object")]),t._v(", and flags associated with the headers.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://localhost'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" req "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'response'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"class-serverhttp2stream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-serverhttp2stream"}},[t._v("#")]),t._v(" Class: ServerHttp2Stream")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {Http2Stream}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("ServerHttp2Stream")]),t._v(" class is an extension of "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v(" that is\nused exclusively on HTTP/2 Servers. "),s("code",[t._v("Http2Stream")]),t._v(" instances on the server\nprovide additional methods such as "),s("code",[t._v("http2stream.pushStream()")]),t._v(" and\n"),s("code",[t._v("http2stream.respond()")]),t._v(" that are only relevant on the server.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-additionalheaders-headers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-additionalheaders-headers"}},[t._v("#")]),t._v(" http2stream.additionalHeaders(headers)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object}")])]),t._v(" "),s("p",[t._v("Sends an additional informational "),s("code",[t._v("HEADERS")]),t._v(" frame to the connected HTTP/2 peer.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-headerssent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-headerssent"}},[t._v("#")]),t._v(" http2stream.headersSent")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("True if headers were sent, false otherwise (read-only).")]),t._v(" "),s("h4",{attrs:{id:"http2stream-pushallowed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-pushallowed"}},[t._v("#")]),t._v(" http2stream.pushAllowed")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Read-only property mapped to the "),s("code",[t._v("SETTINGS_ENABLE_PUSH")]),t._v(" flag of the remote\nclient's most recent "),s("code",[t._v("SETTINGS")]),t._v(" frame. Will be "),s("code",[t._v("true")]),t._v(" if the remote peer\naccepts push streams, "),s("code",[t._v("false")]),t._v(" otherwise. Settings are the same for every\n"),s("code",[t._v("Http2Stream")]),t._v(" in the same "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"http2stream-pushstream-headers-options-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-pushstream-headers-options-callback"}},[t._v("#")]),t._v(" http2stream.pushStream(headers[, options], callback)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object}")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v(" {Object}\n"),s("ul",[s("li",[s("code",[t._v("exclusive")]),t._v(" {boolean} When "),s("code",[t._v("true")]),t._v(" and "),s("code",[t._v("parent")]),t._v(" identifies a parent Stream,\nthe created stream is made the sole direct dependency of the parent, with\nall other existing dependents made a dependent of the newly created stream.\n"),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("false")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("parent")]),t._v(" {number} Specifies the numeric identifier of a stream the newly\ncreated stream is dependent on.")])])]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function} Callback that is called once the push stream has been\ninitiated.\n"),s("ul",[s("li",[s("code",[t._v("err")]),t._v(" {Error}")]),t._v(" "),s("li",[s("code",[t._v("pushStream")]),t._v(" {ServerHttp2Stream} The returned "),s("code",[t._v("pushStream")]),t._v(" object.")]),t._v(" "),s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object} Headers object the "),s("code",[t._v("pushStream")]),t._v(" was\ninitiated with.")])])])]),t._v(" "),s("p",[t._v("Initiates a push stream. The callback is invoked with the new "),s("code",[t._v("Http2Stream")]),t._v("\ninstance created for the push stream passed as the second argument, or an\n"),s("code",[t._v("Error")]),t._v(" passed as the first argument.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushStream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pushStream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    pushStream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    pushStream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'some pushed data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'some data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Setting the weight of a push stream is not allowed in the "),s("code",[t._v("HEADERS")]),t._v(" frame. Pass\na "),s("code",[t._v("weight")]),t._v(" value to "),s("code",[t._v("http2stream.priority")]),t._v(" with the "),s("code",[t._v("silent")]),t._v(" option set to\n"),s("code",[t._v("true")]),t._v(" to enable server-side bandwidth balancing between concurrent streams.")]),t._v(" "),s("p",[t._v("Calling "),s("code",[t._v("http2stream.pushStream()")]),t._v(" from within a pushed stream is not permitted\nand will throw an error.")]),t._v(" "),s("h4",{attrs:{id:"http2stream-respond-headers-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-respond-headers-options"}},[t._v("#")]),t._v(" http2stream.respond([headers[, options]])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object}")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v(" {Object}\n"),s("ul",[s("li",[s("code",[t._v("endStream")]),t._v(" {boolean} Set to "),s("code",[t._v("true")]),t._v(" to indicate that the response will not\ninclude payload data.")]),t._v(" "),s("li",[s("code",[t._v("waitForTrailers")]),t._v(" {boolean} When "),s("code",[t._v("true")]),t._v(", the "),s("code",[t._v("Http2Stream")]),t._v(" will emit the\n"),s("code",[t._v("'wantTrailers'")]),t._v(" event after the final "),s("code",[t._v("DATA")]),t._v(" frame has been sent.")])])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'some data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("When the "),s("code",[t._v("options.waitForTrailers")]),t._v(" option is set, the "),s("code",[t._v("'wantTrailers'")]),t._v(" event\nwill be emitted immediately after queuing the last chunk of payload data to be\nsent. The "),s("code",[t._v("http2stream.sendTrailers()")]),t._v(" method can then be used to sent trailing\nheader fields to the peer.")]),t._v(" "),s("p",[t._v("When "),s("code",[t._v("options.waitForTrailers")]),t._v(" is set, the "),s("code",[t._v("Http2Stream")]),t._v(" will not automatically\nclose when the final "),s("code",[t._v("DATA")]),t._v(" frame is transmitted. User code must call either\n"),s("code",[t._v("http2stream.sendTrailers()")]),t._v(" or "),s("code",[t._v("http2stream.close()")]),t._v(" to close the\n"),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" waitForTrailers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wantTrailers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendTrailers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ABC")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'some value to send'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'some data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"http2stream-respondwithfd-fd-headers-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-respondwithfd-fd-headers-options"}},[t._v("#")]),t._v(" http2stream.respondWithFD(fd[, headers[, options]])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("fd")]),t._v(" {number|FileHandle} A readable file descriptor.")]),t._v(" "),s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object}")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v(" {Object}\n"),s("ul",[s("li",[s("code",[t._v("statCheck")]),t._v(" {Function}")]),t._v(" "),s("li",[s("code",[t._v("waitForTrailers")]),t._v(" {boolean} When "),s("code",[t._v("true")]),t._v(", the "),s("code",[t._v("Http2Stream")]),t._v(" will emit the\n"),s("code",[t._v("'wantTrailers'")]),t._v(" event after the final "),s("code",[t._v("DATA")]),t._v(" frame has been sent.")]),t._v(" "),s("li",[s("code",[t._v("offset")]),t._v(" {number} The offset position at which to begin reading.")]),t._v(" "),s("li",[s("code",[t._v("length")]),t._v(" {number} The amount of data from the fd to send.")])])])]),t._v(" "),s("p",[t._v("Initiates a response whose data is read from the given file descriptor. No\nvalidation is performed on the given file descriptor. If an error occurs while\nattempting to read data using the file descriptor, the "),s("code",[t._v("Http2Stream")]),t._v(" will be\nclosed using an "),s("code",[t._v("RST_STREAM")]),t._v(" frame using the standard "),s("code",[t._v("INTERNAL_ERROR")]),t._v(" code.")]),t._v(" "),s("p",[t._v("When used, the "),s("code",[t._v("Http2Stream")]),t._v(" object's "),s("code",[t._v("Duplex")]),t._v(" interface will be closed\nautomatically.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("openSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/some/file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'r'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" stat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fstatSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" headers "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-length'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" stat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'last-modified'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" stat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mtime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toUTCString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respondWithFD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'close'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("closeSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("The optional "),s("code",[t._v("options.statCheck")]),t._v(" function may be specified to give user code\nan opportunity to set additional content headers based on the "),s("code",[t._v("fs.Stat")]),t._v(" details\nof the given fd. If the "),s("code",[t._v("statCheck")]),t._v(" function is provided, the\n"),s("code",[t._v("http2stream.respondWithFD()")]),t._v(" method will perform an "),s("code",[t._v("fs.fstat()")]),t._v(" call to\ncollect details on the provided file descriptor.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("offset")]),t._v(" and "),s("code",[t._v("length")]),t._v(" options may be used to limit the response to a\nspecific range subset. This can be used, for instance, to support HTTP Range\nrequests.")]),t._v(" "),s("p",[t._v("The file descriptor or "),s("code",[t._v("FileHandle")]),t._v(" is not closed when the stream is closed,\nso it will need to be closed manually once it is no longer needed.\nUsing the same file descriptor concurrently for multiple streams\nis not supported and may result in data loss. Re-using a file descriptor\nafter a stream has finished is supported.")]),t._v(" "),s("p",[t._v("When the "),s("code",[t._v("options.waitForTrailers")]),t._v(" option is set, the "),s("code",[t._v("'wantTrailers'")]),t._v(" event\nwill be emitted immediately after queuing the last chunk of payload data to be\nsent. The "),s("code",[t._v("http2stream.sendTrailers()")]),t._v(" method can then be used to sent trailing\nheader fields to the peer.")]),t._v(" "),s("p",[t._v("When "),s("code",[t._v("options.waitForTrailers")]),t._v(" is set, the "),s("code",[t._v("Http2Stream")]),t._v(" will not automatically\nclose when the final "),s("code",[t._v("DATA")]),t._v(" frame is transmitted. User code "),s("em",[t._v("must")]),t._v(" call either\n"),s("code",[t._v("http2stream.sendTrailers()")]),t._v(" or "),s("code",[t._v("http2stream.close()")]),t._v(" to close the\n"),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("openSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/some/file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'r'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" stat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fstatSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" headers "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-length'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" stat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'last-modified'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" stat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mtime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toUTCString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respondWithFD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" waitForTrailers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wantTrailers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendTrailers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ABC")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'some value to send'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'close'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("closeSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"http2stream-respondwithfile-path-headers-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2stream-respondwithfile-path-headers-options"}},[t._v("#")]),t._v(" http2stream.respondWithFile(path[, headers[, options]])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("path")]),t._v(" {string|Buffer|URL}")]),t._v(" "),s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object}")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v(" {Object}\n"),s("ul",[s("li",[s("code",[t._v("statCheck")]),t._v(" {Function}")]),t._v(" "),s("li",[s("code",[t._v("onError")]),t._v(" {Function} Callback function invoked in the case of an\nerror before send.")]),t._v(" "),s("li",[s("code",[t._v("waitForTrailers")]),t._v(" {boolean} When "),s("code",[t._v("true")]),t._v(", the "),s("code",[t._v("Http2Stream")]),t._v(" will emit the\n"),s("code",[t._v("'wantTrailers'")]),t._v(" event after the final "),s("code",[t._v("DATA")]),t._v(" frame has been sent.")]),t._v(" "),s("li",[s("code",[t._v("offset")]),t._v(" {number} The offset position at which to begin reading.")]),t._v(" "),s("li",[s("code",[t._v("length")]),t._v(" {number} The amount of data from the fd to send.")])])])]),t._v(" "),s("p",[t._v("Sends a regular file as the response. The "),s("code",[t._v("path")]),t._v(" must specify a regular file\nor an "),s("code",[t._v("'error'")]),t._v(" event will be emitted on the "),s("code",[t._v("Http2Stream")]),t._v(" object.")]),t._v(" "),s("p",[t._v("When used, the "),s("code",[t._v("Http2Stream")]),t._v(" object's "),s("code",[t._v("Duplex")]),t._v(" interface will be closed\nautomatically.")]),t._v(" "),s("p",[t._v("The optional "),s("code",[t._v("options.statCheck")]),t._v(" function may be specified to give user code\nan opportunity to set additional content headers based on the "),s("code",[t._v("fs.Stat")]),t._v(" details\nof the given file:")]),t._v(" "),s("p",[t._v("If an error occurs while attempting to read the file data, the "),s("code",[t._v("Http2Stream")]),t._v("\nwill be closed using an "),s("code",[t._v("RST_STREAM")]),t._v(" frame using the standard "),s("code",[t._v("INTERNAL_ERROR")]),t._v("\ncode. If the "),s("code",[t._v("onError")]),t._v(" callback is defined, then it will be called. Otherwise\nthe stream will be destroyed.")]),t._v(" "),s("p",[t._v("Example using a file path:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("statCheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'last-modified'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" stat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mtime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toUTCString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onError")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ENOENT'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respondWithFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/some/file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" statCheck"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onError "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("The "),s("code",[t._v("options.statCheck")]),t._v(" function may also be used to cancel the send operation\nby returning "),s("code",[t._v("false")]),t._v(". For instance, a conditional request may check the stat\nresults to determine if the file has been modified to return an appropriate\n"),s("code",[t._v("304")]),t._v(" response:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("statCheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Check the stat here...")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("304")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Cancel the send operation")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respondWithFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/some/file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" statCheck "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("The "),s("code",[t._v("content-length")]),t._v(" header field will be automatically set.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("offset")]),t._v(" and "),s("code",[t._v("length")]),t._v(" options may be used to limit the response to a\nspecific range subset. This can be used, for instance, to support HTTP Range\nrequests.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("options.onError")]),t._v(" function may also be used to handle all the errors\nthat could happen before the delivery of the file is initiated. The\ndefault behavior is to destroy the stream.")]),t._v(" "),s("p",[t._v("When the "),s("code",[t._v("options.waitForTrailers")]),t._v(" option is set, the "),s("code",[t._v("'wantTrailers'")]),t._v(" event\nwill be emitted immediately after queuing the last chunk of payload data to be\nsent. The "),s("code",[t._v("http2stream.sendTrailers()")]),t._v(" method can then be used to sent trailing\nheader fields to the peer.")]),t._v(" "),s("p",[t._v("When "),s("code",[t._v("options.waitForTrailers")]),t._v(" is set, the "),s("code",[t._v("Http2Stream")]),t._v(" will not automatically\nclose when the final "),s("code",[t._v("DATA")]),t._v(" frame is transmitted. User code must call either\n"),s("code",[t._v("http2stream.sendTrailers()")]),t._v(" or "),s("code",[t._v("http2stream.close()")]),t._v(" to close the\n"),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respondWithFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/some/file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" waitForTrailers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wantTrailers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendTrailers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ABC")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'some value to send'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"class-http2server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-http2server"}},[t._v("#")]),t._v(" Class: Http2Server")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {net.Server}")])]),t._v(" "),s("p",[t._v("Instances of "),s("code",[t._v("Http2Server")]),t._v(" are created using the "),s("code",[t._v("http2.createServer()")]),t._v("\nfunction. The "),s("code",[t._v("Http2Server")]),t._v(" class is not exported directly by the "),s("code",[t._v("http2")]),t._v("\nmodule.")]),t._v(" "),s("h4",{attrs:{id:"event-checkcontinue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-checkcontinue"}},[t._v("#")]),t._v(" Event: 'checkContinue'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("request")]),t._v(" {http2.Http2ServerRequest}")]),t._v(" "),s("li",[s("code",[t._v("response")]),t._v(" {http2.Http2ServerResponse}")])]),t._v(" "),s("p",[t._v("If a "),s("a",{attrs:{href:"#http2_event_request"}},[s("code",[t._v("'request'")])]),t._v(" listener is registered or "),s("a",{attrs:{href:"#http2_http2_createserver_options_onrequesthandler"}},[s("code",[t._v("http2.createServer()")])]),t._v(" is\nsupplied a callback function, the "),s("code",[t._v("'checkContinue'")]),t._v(" event is emitted each time\na request with an HTTP "),s("code",[t._v("Expect: 100-continue")]),t._v(" is received. If this event is\nnot listened for, the server will automatically respond with a status\n"),s("code",[t._v("100 Continue")]),t._v(" as appropriate.")]),t._v(" "),s("p",[t._v("Handling this event involves calling "),s("a",{attrs:{href:"#http2_response_writecontinue"}},[s("code",[t._v("response.writeContinue()")])]),t._v(" if the\nclient should continue to send the request body, or generating an appropriate\nHTTP response (e.g. 400 Bad Request) if the client should not continue to send\nthe request body.")]),t._v(" "),s("p",[t._v("When this event is emitted and handled, the "),s("a",{attrs:{href:"#http2_event_request"}},[s("code",[t._v("'request'")])]),t._v(" event will\nnot be emitted.")]),t._v(" "),s("h4",{attrs:{id:"event-request"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-request"}},[t._v("#")]),t._v(" Event: 'request'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("request")]),t._v(" {http2.Http2ServerRequest}")]),t._v(" "),s("li",[s("code",[t._v("response")]),t._v(" {http2.Http2ServerResponse}")])]),t._v(" "),s("p",[t._v("Emitted each time there is a request. There may be multiple requests\nper session. See the "),s("a",{attrs:{href:"#http2_compatibility_api"}},[t._v("Compatibility API")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-session"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-session"}},[t._v("#")]),t._v(" Event: 'session'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'session'")]),t._v(" event is emitted when a new "),s("code",[t._v("Http2Session")]),t._v(" is created by the\n"),s("code",[t._v("Http2Server")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-sessionerror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-sessionerror"}},[t._v("#")]),t._v(" Event: 'sessionError'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'sessionError'")]),t._v(" event is emitted when an "),s("code",[t._v("'error'")]),t._v(" event is emitted by\nan "),s("code",[t._v("Http2Session")]),t._v(" object associated with the "),s("code",[t._v("Http2Server")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-stream-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-stream-2"}},[t._v("#")]),t._v(" Event: 'stream'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'stream'")]),t._v(" event is emitted when a "),s("code",[t._v("'stream'")]),t._v(" event has been emitted by\nan "),s("code",[t._v("Http2Session")]),t._v(" associated with the server.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_METHOD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_PATH")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_STATUS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_CONTENT_TYPE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constants"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_METHOD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_PATH")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_STATUS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_CONTENT_TYPE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'world'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"event-timeout-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-timeout-3"}},[t._v("#")]),t._v(" Event: 'timeout'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'timeout'")]),t._v(" event is emitted when there is no activity on the Server for\na given number of milliseconds set using "),s("code",[t._v("http2server.setTimeout()")]),t._v(".\n"),s("strong",[t._v("Default:")]),t._v(" 0 (no timeout)")]),t._v(" "),s("h4",{attrs:{id:"server-close-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-close-callback"}},[t._v("#")]),t._v(" server.close([callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("callback")]),t._v(" {Function}")])]),t._v(" "),s("p",[t._v("Stops the server from establishing new sessions. This does not prevent new\nrequest streams from being created due to the persistent nature of HTTP/2\nsessions. To gracefully shut down the server, call "),s("a",{attrs:{href:"#http2_http2session_close_callback"}},[s("code",[t._v("http2session.close()")])]),t._v(" on\nall active sessions.")]),t._v(" "),s("p",[t._v("If "),s("code",[t._v("callback")]),t._v(" is provided, it is not invoked until all active sessions have been\nclosed, although the server has already stopped allowing new sessions. See\n"),s("router-link",{attrs:{to:"/node/net.html#net_server_close_callback"}},[s("code",[t._v("net.Server.close()")])]),t._v(" for more details.")],1),t._v(" "),s("h4",{attrs:{id:"server-settimeout-msecs-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-settimeout-msecs-callback"}},[t._v("#")]),t._v(" server.setTimeout([msecs][, callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("msecs")]),t._v(" {number} "),s("strong",[t._v("Default:")]),t._v(" 0 (no timeout)")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")]),t._v(" "),s("li",[t._v("Returns: {Http2Server}")])]),t._v(" "),s("p",[t._v("Used to set the timeout value for http2 server requests,\nand sets a callback function that is called when there is no activity\non the "),s("code",[t._v("Http2Server")]),t._v(" after "),s("code",[t._v("msecs")]),t._v(" milliseconds.")]),t._v(" "),s("p",[t._v("The given callback is registered as a listener on the "),s("code",[t._v("'timeout'")]),t._v(" event.")]),t._v(" "),s("p",[t._v("In case of no callback function were assigned, a new "),s("code",[t._v("ERR_INVALID_CALLBACK")]),t._v("\nerror will be thrown.")]),t._v(" "),s("h3",{attrs:{id:"class-http2secureserver"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-http2secureserver"}},[t._v("#")]),t._v(" Class: Http2SecureServer")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {tls.Server}")])]),t._v(" "),s("p",[t._v("Instances of "),s("code",[t._v("Http2SecureServer")]),t._v(" are created using the\n"),s("code",[t._v("http2.createSecureServer()")]),t._v(" function. The "),s("code",[t._v("Http2SecureServer")]),t._v(" class is not\nexported directly by the "),s("code",[t._v("http2")]),t._v(" module.")]),t._v(" "),s("h4",{attrs:{id:"event-checkcontinue-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-checkcontinue-2"}},[t._v("#")]),t._v(" Event: 'checkContinue'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("request")]),t._v(" {http2.Http2ServerRequest}")]),t._v(" "),s("li",[s("code",[t._v("response")]),t._v(" {http2.Http2ServerResponse}")])]),t._v(" "),s("p",[t._v("If a "),s("a",{attrs:{href:"#http2_event_request"}},[s("code",[t._v("'request'")])]),t._v(" listener is registered or "),s("a",{attrs:{href:"#http2_http2_createsecureserver_options_onrequesthandler"}},[s("code",[t._v("http2.createSecureServer()")])]),t._v("\nis supplied a callback function, the "),s("code",[t._v("'checkContinue'")]),t._v(" event is emitted each\ntime a request with an HTTP "),s("code",[t._v("Expect: 100-continue")]),t._v(" is received. If this event\nis not listened for, the server will automatically respond with a status\n"),s("code",[t._v("100 Continue")]),t._v(" as appropriate.")]),t._v(" "),s("p",[t._v("Handling this event involves calling "),s("a",{attrs:{href:"#http2_response_writecontinue"}},[s("code",[t._v("response.writeContinue()")])]),t._v(" if the\nclient should continue to send the request body, or generating an appropriate\nHTTP response (e.g. 400 Bad Request) if the client should not continue to send\nthe request body.")]),t._v(" "),s("p",[t._v("When this event is emitted and handled, the "),s("a",{attrs:{href:"#http2_event_request"}},[s("code",[t._v("'request'")])]),t._v(" event will\nnot be emitted.")]),t._v(" "),s("h4",{attrs:{id:"event-request-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-request-2"}},[t._v("#")]),t._v(" Event: 'request'")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("request")]),t._v(" {http2.Http2ServerRequest}")]),t._v(" "),s("li",[s("code",[t._v("response")]),t._v(" {http2.Http2ServerResponse}")])]),t._v(" "),s("p",[t._v("Emitted each time there is a request. There may be multiple requests\nper session. See the "),s("a",{attrs:{href:"#http2_compatibility_api"}},[t._v("Compatibility API")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-session-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-session-2"}},[t._v("#")]),t._v(" Event: 'session'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'session'")]),t._v(" event is emitted when a new "),s("code",[t._v("Http2Session")]),t._v(" is created by the\n"),s("code",[t._v("Http2SecureServer")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-sessionerror-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-sessionerror-2"}},[t._v("#")]),t._v(" Event: 'sessionError'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'sessionError'")]),t._v(" event is emitted when an "),s("code",[t._v("'error'")]),t._v(" event is emitted by\nan "),s("code",[t._v("Http2Session")]),t._v(" object associated with the "),s("code",[t._v("Http2SecureServer")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"event-stream-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-stream-3"}},[t._v("#")]),t._v(" Event: 'stream'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'stream'")]),t._v(" event is emitted when a "),s("code",[t._v("'stream'")]),t._v(" event has been emitted by\nan "),s("code",[t._v("Http2Session")]),t._v(" associated with the server.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_METHOD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_PATH")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_STATUS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_CONTENT_TYPE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constants"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getOptionsSomehow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createSecureServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_METHOD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_PATH")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_STATUS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_CONTENT_TYPE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'world'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"event-timeout-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-timeout-4"}},[t._v("#")]),t._v(" Event: 'timeout'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'timeout'")]),t._v(" event is emitted when there is no activity on the Server for\na given number of milliseconds set using "),s("code",[t._v("http2secureServer.setTimeout()")]),t._v(".\n"),s("strong",[t._v("Default:")]),t._v(" 2 minutes.")]),t._v(" "),s("h4",{attrs:{id:"event-unknownprotocol"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-unknownprotocol"}},[t._v("#")]),t._v(" Event: 'unknownProtocol'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'unknownProtocol'")]),t._v(" event is emitted when a connecting client fails to\nnegotiate an allowed protocol (i.e. HTTP/2 or HTTP/1.1). The event handler\nreceives the socket for handling. If no listener is registered for this event,\nthe connection is terminated. See the "),s("a",{attrs:{href:"#http2_compatibility_api"}},[t._v("Compatibility API")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"server-close-callback-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-close-callback-2"}},[t._v("#")]),t._v(" server.close([callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("callback")]),t._v(" {Function}")])]),t._v(" "),s("p",[t._v("Stops the server from establishing new sessions. This does not prevent new\nrequest streams from being created due to the persistent nature of HTTP/2\nsessions. To gracefully shut down the server, call "),s("a",{attrs:{href:"#http2_http2session_close_callback"}},[s("code",[t._v("http2session.close()")])]),t._v(" on\nall active sessions.")]),t._v(" "),s("p",[t._v("If "),s("code",[t._v("callback")]),t._v(" is provided, it is not invoked until all active sessions have been\nclosed, although the server has already stopped allowing new sessions. See\n"),s("router-link",{attrs:{to:"/node/tls.html#tls_server_close_callback"}},[s("code",[t._v("tls.Server.close()")])]),t._v(" for more details.")],1),t._v(" "),s("h4",{attrs:{id:"server-settimeout-msecs-callback-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-settimeout-msecs-callback-2"}},[t._v("#")]),t._v(" server.setTimeout([msecs][, callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("msecs")]),t._v(" {number} "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("120000")]),t._v(" (2 minutes)")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")]),t._v(" "),s("li",[t._v("Returns: {Http2SecureServer}")])]),t._v(" "),s("p",[t._v("Used to set the timeout value for http2 secure server requests,\nand sets a callback function that is called when there is no activity\non the "),s("code",[t._v("Http2SecureServer")]),t._v(" after "),s("code",[t._v("msecs")]),t._v(" milliseconds.")]),t._v(" "),s("p",[t._v("The given callback is registered as a listener on the "),s("code",[t._v("'timeout'")]),t._v(" event.")]),t._v(" "),s("p",[t._v("In case of no callback function were assigned, a new "),s("code",[t._v("ERR_INVALID_CALLBACK")]),t._v("\nerror will be thrown.")]),t._v(" "),s("h3",{attrs:{id:"http2-createserver-options-onrequesthandler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2-createserver-options-onrequesthandler"}},[t._v("#")]),t._v(" http2.createServer(options[, onRequestHandler])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("options")]),t._v(" {Object}\n"),s("ul",[s("li",[s("code",[t._v("maxDeflateDynamicTableSize")]),t._v(" {number} Sets the maximum dynamic table size\nfor deflating header fields. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("4Kib")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxSessionMemory")]),t._v("{number} Sets the maximum memory that the "),s("code",[t._v("Http2Session")]),t._v("\nis permitted to use. The value is expressed in terms of number of megabytes,\ne.g. "),s("code",[t._v("1")]),t._v(" equal 1 megabyte. The minimum value allowed is "),s("code",[t._v("1")]),t._v(".\nThis is a credit based limit, existing "),s("code",[t._v("Http2Stream")]),t._v("s may cause this\nlimit to be exceeded, but new "),s("code",[t._v("Http2Stream")]),t._v(" instances will be rejected\nwhile this limit is exceeded. The current number of "),s("code",[t._v("Http2Stream")]),t._v(" sessions,\nthe current memory use of the header compression tables, current data\nqueued to be sent, and unacknowledged "),s("code",[t._v("PING")]),t._v(" and "),s("code",[t._v("SETTINGS")]),t._v(" frames are all\ncounted towards the current limit. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("10")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxHeaderListPairs")]),t._v(" {number} Sets the maximum number of header entries.\nThe minimum value is "),s("code",[t._v("4")]),t._v(". "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("128")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxOutstandingPings")]),t._v(" {number} Sets the maximum number of outstanding,\nunacknowledged pings. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("10")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxSendHeaderBlockLength")]),t._v(" {number} Sets the maximum allowed size for a\nserialized, compressed block of headers. Attempts to send headers that\nexceed this limit will result in a "),s("code",[t._v("'frameError'")]),t._v(" event being emitted\nand the stream being closed and destroyed.")]),t._v(" "),s("li",[s("code",[t._v("paddingStrategy")]),t._v(" {number} The strategy used for determining the amount of\npadding to use for "),s("code",[t._v("HEADERS")]),t._v(" and "),s("code",[t._v("DATA")]),t._v(" frames. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("http2.constants.PADDING_STRATEGY_NONE")]),t._v(". Value may be one of:\n"),s("ul",[s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_NONE")]),t._v(": No padding is applied.")]),t._v(" "),s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_MAX")]),t._v(": The maximum amount of padding,\ndetermined by the internal implementation, is applied.")]),t._v(" "),s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_ALIGNED")]),t._v(": Attempts to apply enough\npadding to ensure that the total frame length, including the 9-byte\nheader, is a multiple of 8. For each frame, there is a maximum allowed\nnumber of padding bytes that is determined by current flow control state\nand settings. If this maximum is less than the calculated amount needed to\nensure alignment, the maximum is used and the total frame length is not\nnecessarily aligned at 8 bytes.")])])]),t._v(" "),s("li",[s("code",[t._v("peerMaxConcurrentStreams")]),t._v(" {number} Sets the maximum number of concurrent\nstreams for the remote peer as if a "),s("code",[t._v("SETTINGS")]),t._v(" frame had been received. Will\nbe overridden if the remote peer sets its own value for\n"),s("code",[t._v("maxConcurrentStreams")]),t._v(". "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("100")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("settings")]),t._v(" {HTTP/2 Settings Object} The initial settings to send to the\nremote peer upon connection.")]),t._v(" "),s("li",[s("code",[t._v("Http1IncomingMessage")]),t._v(" {http.IncomingMessage} Specifies the\n"),s("code",[t._v("IncomingMessage")]),t._v(" class to used for HTTP/1 fallback. Useful for extending\nthe original "),s("code",[t._v("http.IncomingMessage")]),t._v(". "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("http.IncomingMessage")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("Http1ServerResponse")]),t._v(" {http.ServerResponse} Specifies the "),s("code",[t._v("ServerResponse")]),t._v("\nclass to used for HTTP/1 fallback. Useful for extending the original\n"),s("code",[t._v("http.ServerResponse")]),t._v(". "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("http.ServerResponse")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("Http2ServerRequest")]),t._v(" {http2.Http2ServerRequest} Specifies the\n"),s("code",[t._v("Http2ServerRequest")]),t._v(" class to use.\nUseful for extending the original "),s("code",[t._v("Http2ServerRequest")]),t._v(".\n"),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("Http2ServerRequest")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("Http2ServerResponse")]),t._v(" {http2.Http2ServerResponse} Specifies the\n"),s("code",[t._v("Http2ServerResponse")]),t._v(" class to use.\nUseful for extending the original "),s("code",[t._v("Http2ServerResponse")]),t._v(".\n"),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("Http2ServerResponse")]),t._v(".")]),t._v(" "),s("li",[t._v("...: Any "),s("router-link",{attrs:{to:"/node/net.html#net_net_createserver_options_connectionlistener"}},[s("code",[t._v("net.createServer()")])]),t._v(" option can be provided.")],1)])]),t._v(" "),s("li",[s("code",[t._v("onRequestHandler")]),t._v(" {Function} See "),s("a",{attrs:{href:"#http2_compatibility_api"}},[t._v("Compatibility API")])]),t._v(" "),s("li",[t._v("Returns: {Http2Server}")])]),t._v(" "),s("p",[t._v("Returns a "),s("code",[t._v("net.Server")]),t._v(" instance that creates and manages "),s("code",[t._v("Http2Session")]),t._v("\ninstances.")]),t._v(" "),s("p",[t._v("Since there are no browsers known that support\n"),s("a",{attrs:{href:"https://http2.github.io/faq/#does-http2-require-encryption",target:"_blank",rel:"noopener noreferrer"}},[t._v("unencrypted HTTP/2"),s("OutboundLink")],1),t._v(", the use of\n"),s("a",{attrs:{href:"#http2_http2_createsecureserver_options_onrequesthandler"}},[s("code",[t._v("http2.createSecureServer()")])]),t._v(" is necessary when communicating\nwith browser clients.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create an unencrypted HTTP/2 server.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Since there are no browsers known that support")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// unencrypted HTTP/2, the use of `http2.createSecureServer()`")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// is necessary when communicating with browser clients.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<h1>Hello World</h1>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"http2-createsecureserver-options-onrequesthandler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2-createsecureserver-options-onrequesthandler"}},[t._v("#")]),t._v(" http2.createSecureServer(options[, onRequestHandler])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("options")]),t._v(" {Object}\n"),s("ul",[s("li",[s("code",[t._v("allowHTTP1")]),t._v(" {boolean} Incoming client connections that do not support\nHTTP/2 will be downgraded to HTTP/1.x when set to "),s("code",[t._v("true")]),t._v(".\nSee the "),s("a",{attrs:{href:"#http2_event_unknownprotocol"}},[s("code",[t._v("'unknownProtocol'")])]),t._v(" event. See "),s("a",{attrs:{href:"#http2_alpn_negotiation"}},[t._v("ALPN negotiation")]),t._v(".\n"),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("false")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxDeflateDynamicTableSize")]),t._v(" {number} Sets the maximum dynamic table size\nfor deflating header fields. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("4Kib")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxSessionMemory")]),t._v("{number} Sets the maximum memory that the "),s("code",[t._v("Http2Session")]),t._v("\nis permitted to use. The value is expressed in terms of number of megabytes,\ne.g. "),s("code",[t._v("1")]),t._v(" equal 1 megabyte. The minimum value allowed is "),s("code",[t._v("1")]),t._v(". This is a\ncredit based limit, existing "),s("code",[t._v("Http2Stream")]),t._v("s may cause this\nlimit to be exceeded, but new "),s("code",[t._v("Http2Stream")]),t._v(" instances will be rejected\nwhile this limit is exceeded. The current number of "),s("code",[t._v("Http2Stream")]),t._v(" sessions,\nthe current memory use of the header compression tables, current data\nqueued to be sent, and unacknowledged "),s("code",[t._v("PING")]),t._v(" and "),s("code",[t._v("SETTINGS")]),t._v(" frames are all\ncounted towards the current limit. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("10")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxHeaderListPairs")]),t._v(" {number} Sets the maximum number of header entries.\nThe minimum value is "),s("code",[t._v("4")]),t._v(". "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("128")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxOutstandingPings")]),t._v(" {number} Sets the maximum number of outstanding,\nunacknowledged pings. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("10")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxSendHeaderBlockLength")]),t._v(" {number} Sets the maximum allowed size for a\nserialized, compressed block of headers. Attempts to send headers that\nexceed this limit will result in a "),s("code",[t._v("'frameError'")]),t._v(" event being emitted\nand the stream being closed and destroyed.")]),t._v(" "),s("li",[s("code",[t._v("paddingStrategy")]),t._v(" {number} Strategy used for determining the amount of\npadding to use for "),s("code",[t._v("HEADERS")]),t._v(" and "),s("code",[t._v("DATA")]),t._v(" frames. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("http2.constants.PADDING_STRATEGY_NONE")]),t._v(". Value may be one of:\n"),s("ul",[s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_NONE")]),t._v(": No padding is applied.")]),t._v(" "),s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_MAX")]),t._v(": The maximum amount of padding,\ndetermined by the internal implementation, is applied.")]),t._v(" "),s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_ALIGNED")]),t._v(": Attempts to apply enough\npadding to ensure that the total frame length, including the\n9-byte header, is a multiple of 8. For each frame, there is a maximum\nallowed number of padding bytes that is determined by current flow control\nstate and settings. If this maximum is less than the calculated amount\nneeded to ensure alignment, the maximum is used and the total frame length\nis not necessarily aligned at 8 bytes.")])])]),t._v(" "),s("li",[s("code",[t._v("peerMaxConcurrentStreams")]),t._v(" {number} Sets the maximum number of concurrent\nstreams for the remote peer as if a "),s("code",[t._v("SETTINGS")]),t._v(" frame had been received. Will\nbe overridden if the remote peer sets its own value for\n"),s("code",[t._v("maxConcurrentStreams")]),t._v(". "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("100")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("settings")]),t._v(" {HTTP/2 Settings Object} The initial settings to send to the\nremote peer upon connection.")]),t._v(" "),s("li",[t._v("...: Any "),s("router-link",{attrs:{to:"/node/tls.html#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[t._v("tls.createServer()")])]),t._v(" options can be provided. For\nservers, the identity options ("),s("code",[t._v("pfx")]),t._v(" or "),s("code",[t._v("key")]),t._v("/"),s("code",[t._v("cert")]),t._v(") are usually required.")],1),t._v(" "),s("li",[s("code",[t._v("origins")]),t._v(" {string[]} An array of origin strings to send within an "),s("code",[t._v("ORIGIN")]),t._v("\nframe immediately following creation of a new server "),s("code",[t._v("Http2Session")]),t._v(".")])])]),t._v(" "),s("li",[s("code",[t._v("onRequestHandler")]),t._v(" {Function} See "),s("a",{attrs:{href:"#http2_compatibility_api"}},[t._v("Compatibility API")])]),t._v(" "),s("li",[t._v("Returns: {Http2SecureServer}")])]),t._v(" "),s("p",[t._v("Returns a "),s("code",[t._v("tls.Server")]),t._v(" instance that creates and manages "),s("code",[t._v("Http2Session")]),t._v("\ninstances.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'server-key.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'server-cert.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create a secure HTTP/2 server")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createSecureServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<h1>Hello World</h1>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"http2-connect-authority-options-listener"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2-connect-authority-options-listener"}},[t._v("#")]),t._v(" http2.connect(authority[, options][, listener])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("authority")]),t._v(" {string|URL}")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v(" {Object}\n"),s("ul",[s("li",[s("code",[t._v("maxDeflateDynamicTableSize")]),t._v(" {number} Sets the maximum dynamic table size\nfor deflating header fields. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("4Kib")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxSessionMemory")]),t._v("{number} Sets the maximum memory that the "),s("code",[t._v("Http2Session")]),t._v("\nis permitted to use. The value is expressed in terms of number of megabytes,\ne.g. "),s("code",[t._v("1")]),t._v(" equal 1 megabyte. The minimum value allowed is "),s("code",[t._v("1")]),t._v(".\nThis is a credit based limit, existing "),s("code",[t._v("Http2Stream")]),t._v("s may cause this\nlimit to be exceeded, but new "),s("code",[t._v("Http2Stream")]),t._v(" instances will be rejected\nwhile this limit is exceeded. The current number of "),s("code",[t._v("Http2Stream")]),t._v(" sessions,\nthe current memory use of the header compression tables, current data\nqueued to be sent, and unacknowledged "),s("code",[t._v("PING")]),t._v(" and "),s("code",[t._v("SETTINGS")]),t._v(" frames are all\ncounted towards the current limit. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("10")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxHeaderListPairs")]),t._v(" {number} Sets the maximum number of header entries.\nThe minimum value is "),s("code",[t._v("1")]),t._v(". "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("128")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxOutstandingPings")]),t._v(" {number} Sets the maximum number of outstanding,\nunacknowledged pings. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("10")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxReservedRemoteStreams")]),t._v(" {number} Sets the maximum number of reserved push\nstreams the client will accept at any given time. Once the current number of\ncurrently reserved push streams exceeds reaches this limit, new push streams\nsent by the server will be automatically rejected. The minimum allowed value\nis 0. The maximum allowed value is 2"),s("sup",[t._v("32")]),t._v("-1. A negative value sets\nthis option to the maximum allowed value. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("200")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxSendHeaderBlockLength")]),t._v(" {number} Sets the maximum allowed size for a\nserialized, compressed block of headers. Attempts to send headers that\nexceed this limit will result in a "),s("code",[t._v("'frameError'")]),t._v(" event being emitted\nand the stream being closed and destroyed.")]),t._v(" "),s("li",[s("code",[t._v("paddingStrategy")]),t._v(" {number} Strategy used for determining the amount of\npadding to use for "),s("code",[t._v("HEADERS")]),t._v(" and "),s("code",[t._v("DATA")]),t._v(" frames. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("http2.constants.PADDING_STRATEGY_NONE")]),t._v(". Value may be one of:\n"),s("ul",[s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_NONE")]),t._v(": No padding is applied.")]),t._v(" "),s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_MAX")]),t._v(": The maximum amount of padding,\ndetermined by the internal implementation, is applied.")]),t._v(" "),s("li",[s("code",[t._v("http2.constants.PADDING_STRATEGY_ALIGNED")]),t._v(": Attemps to apply enough\npadding to ensure that the total frame length, including the\n9-byte header, is a multiple of 8. For each frame, there is a maximum\nallowed number of padding bytes that is determined by current flow control\nstate and settings. If this maximum is less than the calculated amount\nneeded to ensure alignment, the maximum is used and the total frame length\nis not necessarily aligned at 8 bytes.")])])]),t._v(" "),s("li",[s("code",[t._v("peerMaxConcurrentStreams")]),t._v(" {number} Sets the maximum number of concurrent\nstreams for the remote peer as if a "),s("code",[t._v("SETTINGS")]),t._v(" frame had been received. Will\nbe overridden if the remote peer sets its own value for\n"),s("code",[t._v("maxConcurrentStreams")]),t._v(". "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("100")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("settings")]),t._v(" {HTTP/2 Settings Object} The initial settings to send to the\nremote peer upon connection.")]),t._v(" "),s("li",[s("code",[t._v("createConnection")]),t._v(" {Function} An optional callback that receives the "),s("code",[t._v("URL")]),t._v("\ninstance passed to "),s("code",[t._v("connect")]),t._v(" and the "),s("code",[t._v("options")]),t._v(" object, and returns any\n"),s("router-link",{attrs:{to:"/node/stream.html#stream_class_stream_duplex"}},[s("code",[t._v("Duplex")])]),t._v(" stream that is to be used as the connection for this session.")],1),t._v(" "),s("li",[t._v("...: Any "),s("router-link",{attrs:{to:"/node/net.html#net_net_connect"}},[s("code",[t._v("net.connect()")])]),t._v(" or "),s("router-link",{attrs:{to:"/node/tls.html#tls_tls_connect_options_callback"}},[s("code",[t._v("tls.connect()")])]),t._v(" options can be provided.")],1)])]),t._v(" "),s("li",[s("code",[t._v("listener")]),t._v(" {Function} Will be registered as a one-time listener of the\n"),s("a",{attrs:{href:"#http2_event_connect"}},[s("code",[t._v("'connect'")])]),t._v(" event.")]),t._v(" "),s("li",[t._v("Returns: {ClientHttp2Session}")])]),t._v(" "),s("p",[t._v("Returns a "),s("code",[t._v("ClientHttp2Session")]),t._v(" instance.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://localhost:1234'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Use the client */")]),t._v("\n\nclient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"http2-constants"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2-constants"}},[t._v("#")]),t._v(" http2.constants")]),t._v(" "),s("h4",{attrs:{id:"error-codes-for-rst-stream-and-goaway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error-codes-for-rst-stream-and-goaway"}},[t._v("#")]),t._v(" Error Codes for RST_STREAM and GOAWAY")]),t._v(" "),s("p",[s("a",{attrs:{id:"error_codes"}})]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Value")]),t._v(" "),s("th",[t._v("Name")]),t._v(" "),s("th",[t._v("Constant")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("0x00")])]),t._v(" "),s("td",[t._v("No Error")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_NO_ERROR")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x01")])]),t._v(" "),s("td",[t._v("Protocol Error")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_PROTOCOL_ERROR")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x02")])]),t._v(" "),s("td",[t._v("Internal Error")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_INTERNAL_ERROR")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x03")])]),t._v(" "),s("td",[t._v("Flow Control Error")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_FLOW_CONTROL_ERROR")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x04")])]),t._v(" "),s("td",[t._v("Settings Timeout")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_SETTINGS_TIMEOUT")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x05")])]),t._v(" "),s("td",[t._v("Stream Closed")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_STREAM_CLOSED")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x06")])]),t._v(" "),s("td",[t._v("Frame Size Error")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_FRAME_SIZE_ERROR")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x07")])]),t._v(" "),s("td",[t._v("Refused Stream")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_REFUSED_STREAM")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x08")])]),t._v(" "),s("td",[t._v("Cancel")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_CANCEL")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x09")])]),t._v(" "),s("td",[t._v("Compression Error")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_COMPRESSION_ERROR")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x0a")])]),t._v(" "),s("td",[t._v("Connect Error")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_CONNECT_ERROR")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x0b")])]),t._v(" "),s("td",[t._v("Enhance Your Calm")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_ENHANCE_YOUR_CALM")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x0c")])]),t._v(" "),s("td",[t._v("Inadequate Security")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_INADEQUATE_SECURITY")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("0x0d")])]),t._v(" "),s("td",[t._v("HTTP/1.1 Required")]),t._v(" "),s("td",[s("code",[t._v("http2.constants.NGHTTP2_HTTP_1_1_REQUIRED")])])])])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'timeout'")]),t._v(" event is emitted when there is no activity on the Server for\na given number of milliseconds set using "),s("code",[t._v("http2server.setTimeout()")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"http2-getdefaultsettings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2-getdefaultsettings"}},[t._v("#")]),t._v(" http2.getDefaultSettings()")]),t._v(" "),s("ul",[s("li",[t._v("Returns: {HTTP/2 Settings Object}")])]),t._v(" "),s("p",[t._v("Returns an object containing the default settings for an "),s("code",[t._v("Http2Session")]),t._v("\ninstance. This method returns a new object instance every time it is called\nso instances returned may be safely modified for use.")]),t._v(" "),s("h3",{attrs:{id:"http2-getpackedsettings-settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2-getpackedsettings-settings"}},[t._v("#")]),t._v(" http2.getPackedSettings([settings])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("settings")]),t._v(" {HTTP/2 Settings Object}")]),t._v(" "),s("li",[t._v("Returns: {Buffer}")])]),t._v(" "),s("p",[t._v("Returns a "),s("code",[t._v("Buffer")]),t._v(" instance containing serialized representation of the given\nHTTP/2 settings as specified in the "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc7540",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP/2"),s("OutboundLink")],1),t._v(" specification. This is intended\nfor use with the "),s("code",[t._v("HTTP2-Settings")]),t._v(" header field.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" packed "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPackedSettings")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" enablePush"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("packed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'base64'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Prints: AAIAAAAA")]),t._v("\n")])])]),s("h3",{attrs:{id:"http2-getunpackedsettings-buf"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http2-getunpackedsettings-buf"}},[t._v("#")]),t._v(" http2.getUnpackedSettings(buf)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("buf")]),t._v(" {Buffer|Uint8Array} The packed settings.")]),t._v(" "),s("li",[t._v("Returns: {HTTP/2 Settings Object}")])]),t._v(" "),s("p",[t._v("Returns a "),s("a",{attrs:{href:"#http2_settings_object"}},[t._v("HTTP/2 Settings Object")]),t._v(" containing the deserialized settings from\nthe given "),s("code",[t._v("Buffer")]),t._v(" as generated by "),s("code",[t._v("http2.getPackedSettings()")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"headers-object"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#headers-object"}},[t._v("#")]),t._v(" Headers Object")]),t._v(" "),s("p",[t._v("Headers are represented as own-properties on JavaScript objects. The property\nkeys will be serialized to lower-case. Property values should be strings (if\nthey are not they will be coerced to strings) or an "),s("code",[t._v("Array")]),t._v(" of strings (in order\nto send more than one value per header field).")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" headers "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':status'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'200'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text-plain'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ABC'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'has'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'more'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'than'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'one'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nstream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Header objects passed to callback functions will have a "),s("code",[t._v("null")]),t._v(" prototype. This\nmeans that normal JavaScript object methods such as\n"),s("code",[t._v("Object.prototype.toString()")]),t._v(" and "),s("code",[t._v("Object.prototype.hasOwnProperty()")]),t._v(" will\nnot work.")]),t._v(" "),s("p",[t._v("For incoming headers:")]),t._v(" "),s("ul",[s("li",[t._v("The "),s("code",[t._v(":status")]),t._v(" header is converted to "),s("code",[t._v("number")]),t._v(".")]),t._v(" "),s("li",[t._v("Duplicates of "),s("code",[t._v(":status")]),t._v(", "),s("code",[t._v(":method")]),t._v(", "),s("code",[t._v(":authority")]),t._v(", "),s("code",[t._v(":scheme")]),t._v(", "),s("code",[t._v(":path")]),t._v(",\n"),s("code",[t._v(":protocol")]),t._v(", "),s("code",[t._v("age")]),t._v(", "),s("code",[t._v("authorization")]),t._v(", "),s("code",[t._v("access-control-allow-credentials")]),t._v(",\n"),s("code",[t._v("access-control-max-age")]),t._v(", "),s("code",[t._v("access-control-request-method")]),t._v(", "),s("code",[t._v("content-encoding")]),t._v(",\n"),s("code",[t._v("content-language")]),t._v(", "),s("code",[t._v("content-length")]),t._v(", "),s("code",[t._v("content-location")]),t._v(", "),s("code",[t._v("content-md5")]),t._v(",\n"),s("code",[t._v("content-range")]),t._v(", "),s("code",[t._v("content-type")]),t._v(", "),s("code",[t._v("date")]),t._v(", "),s("code",[t._v("dnt")]),t._v(", "),s("code",[t._v("etag")]),t._v(", "),s("code",[t._v("expires")]),t._v(", "),s("code",[t._v("from")]),t._v(",\n"),s("code",[t._v("if-match")]),t._v(", "),s("code",[t._v("if-modified-since")]),t._v(", "),s("code",[t._v("if-none-match")]),t._v(", "),s("code",[t._v("if-range")]),t._v(",\n"),s("code",[t._v("if-unmodified-since")]),t._v(", "),s("code",[t._v("last-modified")]),t._v(", "),s("code",[t._v("location")]),t._v(", "),s("code",[t._v("max-forwards")]),t._v(",\n"),s("code",[t._v("proxy-authorization")]),t._v(", "),s("code",[t._v("range")]),t._v(", "),s("code",[t._v("referer")]),t._v(","),s("code",[t._v("retry-after")]),t._v(", "),s("code",[t._v("tk")]),t._v(",\n"),s("code",[t._v("upgrade-insecure-requests")]),t._v(", "),s("code",[t._v("user-agent")]),t._v(" or "),s("code",[t._v("x-content-type-options")]),t._v(" are\ndiscarded.")]),t._v(" "),s("li",[s("code",[t._v("set-cookie")]),t._v(" is always an array. Duplicates are added to the array.")]),t._v(" "),s("li",[t._v("For duplicate "),s("code",[t._v("cookie")]),t._v(" headers, the values are joined together with '; '.")]),t._v(" "),s("li",[t._v("For all other headers, the values are joined together with ', '.")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ABC")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"settings-object"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#settings-object"}},[t._v("#")]),t._v(" Settings Object")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("http2.getDefaultSettings()")]),t._v(", "),s("code",[t._v("http2.getPackedSettings()")]),t._v(",\n"),s("code",[t._v("http2.createServer()")]),t._v(", "),s("code",[t._v("http2.createSecureServer()")]),t._v(",\n"),s("code",[t._v("http2session.settings()")]),t._v(", "),s("code",[t._v("http2session.localSettings")]),t._v(", and\n"),s("code",[t._v("http2session.remoteSettings")]),t._v(" APIs either return or receive as input an\nobject that defines configuration settings for an "),s("code",[t._v("Http2Session")]),t._v(" object.\nThese objects are ordinary JavaScript objects containing the following\nproperties.")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("headerTableSize")]),t._v(" {number} Specifies the maximum number of bytes used for\nheader compression. The minimum allowed value is 0. The maximum allowed value\nis 2"),s("sup",[t._v("32")]),t._v("-1. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("4,096 octets")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("enablePush")]),t._v(" {boolean} Specifies "),s("code",[t._v("true")]),t._v(" if HTTP/2 Push Streams are to be\npermitted on the "),s("code",[t._v("Http2Session")]),t._v(" instances.")]),t._v(" "),s("li",[s("code",[t._v("initialWindowSize")]),t._v(" {number} Specifies the "),s("em",[t._v("senders")]),t._v(" initial window size\nfor stream-level flow control. The minimum allowed value is 0. The maximum\nallowed value is 2"),s("sup",[t._v("32")]),t._v("-1. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("65,535 bytes")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxFrameSize")]),t._v(" {number} Specifies the size of the largest frame payload.\nThe minimum allowed value is 16,384. The maximum allowed value\nis 2"),s("sup",[t._v("24")]),t._v("-1. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("16,384 bytes")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxConcurrentStreams")]),t._v(" {number} Specifies the maximum number of concurrent\nstreams permitted on an "),s("code",[t._v("Http2Session")]),t._v(". There is no default value which\nimplies, at least theoretically, 2"),s("sup",[t._v("32")]),t._v("-1 streams may be open\nconcurrently at any given time in an "),s("code",[t._v("Http2Session")]),t._v(". The minimum value\nis 0. The maximum allowed value is 2"),s("sup",[t._v("32")]),t._v("-1. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("4294967295")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxHeaderListSize")]),t._v(" {number} Specifies the maximum size (uncompressed octets)\nof header list that will be accepted. The minimum allowed value is 0. The\nmaximum allowed value is 2"),s("sup",[t._v("32")]),t._v("-1. "),s("strong",[t._v("Default:")]),t._v(" "),s("code",[t._v("65535")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("enableConnectProtocol")]),t._v("{boolean} Specifies "),s("code",[t._v("true")]),t._v(' if the "Extended Connect\nProtocol" defined by '),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc8441",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 8441"),s("OutboundLink")],1),t._v(" is to be enabled. This setting is only\nmeaningful if sent by the server. Once the "),s("code",[t._v("enableConnectProtocol")]),t._v(" setting\nhas been enabled for a given "),s("code",[t._v("Http2Session")]),t._v(", it cannot be disabled.")])]),t._v(" "),s("p",[t._v("All additional properties on the settings object are ignored.")]),t._v(" "),s("h3",{attrs:{id:"error-handling"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error-handling"}},[t._v("#")]),t._v(" Error Handling")]),t._v(" "),s("p",[t._v("There are several types of error conditions that may arise when using the\n"),s("code",[t._v("http2")]),t._v(" module:")]),t._v(" "),s("p",[t._v("Validation errors occur when an incorrect argument, option, or setting value is\npassed in. These will always be reported by a synchronous "),s("code",[t._v("throw")]),t._v(".")]),t._v(" "),s("p",[t._v("State errors occur when an action is attempted at an incorrect time (for\ninstance, attempting to send data on a stream after it has closed). These will\nbe reported using either a synchronous "),s("code",[t._v("throw")]),t._v(" or via an "),s("code",[t._v("'error'")]),t._v(" event on\nthe "),s("code",[t._v("Http2Stream")]),t._v(", "),s("code",[t._v("Http2Session")]),t._v(" or HTTP/2 Server objects, depending on where\nand when the error occurs.")]),t._v(" "),s("p",[t._v("Internal errors occur when an HTTP/2 session fails unexpectedly. These will be\nreported via an "),s("code",[t._v("'error'")]),t._v(" event on the "),s("code",[t._v("Http2Session")]),t._v(" or HTTP/2 Server objects.")]),t._v(" "),s("p",[t._v("Protocol errors occur when various HTTP/2 protocol constraints are violated.\nThese will be reported using either a synchronous "),s("code",[t._v("throw")]),t._v(" or via an "),s("code",[t._v("'error'")]),t._v("\nevent on the "),s("code",[t._v("Http2Stream")]),t._v(", "),s("code",[t._v("Http2Session")]),t._v(" or HTTP/2 Server objects, depending\non where and when the error occurs.")]),t._v(" "),s("h3",{attrs:{id:"invalid-character-handling-in-header-names-and-values"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#invalid-character-handling-in-header-names-and-values"}},[t._v("#")]),t._v(" Invalid character handling in header names and values")]),t._v(" "),s("p",[t._v("The HTTP/2 implementation applies stricter handling of invalid characters in\nHTTP header names and values than the HTTP/1 implementation.")]),t._v(" "),s("p",[t._v("Header field names are "),s("em",[t._v("case-insensitive")]),t._v(" and are transmitted over the wire\nstrictly as lower-case strings. The API provided by Node.js allows header\nnames to be set as mixed-case strings (e.g. "),s("code",[t._v("Content-Type")]),t._v(") but will convert\nthose to lower-case (e.g. "),s("code",[t._v("content-type")]),t._v(") upon transmission.")]),t._v(" "),s("p",[t._v("Header field-names "),s("em",[t._v("must only")]),t._v(" contain one or more of the following ASCII\ncharacters: "),s("code",[t._v("a")]),t._v("-"),s("code",[t._v("z")]),t._v(", "),s("code",[t._v("A")]),t._v("-"),s("code",[t._v("Z")]),t._v(", "),s("code",[t._v("0")]),t._v("-"),s("code",[t._v("9")]),t._v(", "),s("code",[t._v("!")]),t._v(", "),s("code",[t._v("#")]),t._v(", "),s("code",[t._v("$")]),t._v(", "),s("code",[t._v("%")]),t._v(", "),s("code",[t._v("&")]),t._v(", "),s("code",[t._v("'")]),t._v(", "),s("code",[t._v("*")]),t._v(", "),s("code",[t._v("+")]),t._v(",\n"),s("code",[t._v("-")]),t._v(", "),s("code",[t._v(".")]),t._v(", "),s("code",[t._v("^")]),t._v(", "),s("code",[t._v("_")]),t._v(", "),s("code",[t._v("`")]),t._v(" (backtick), "),s("code",[t._v("|")]),t._v(", and "),s("code",[t._v("~")]),t._v(".")]),t._v(" "),s("p",[t._v("Using invalid characters within an HTTP header field name will cause the\nstream to be closed with a protocol error being reported.")]),t._v(" "),s("p",[t._v("Header field values are handled with more leniency but "),s("em",[t._v("should")]),t._v(" not contain\nnew-line or carriage return characters and "),s("em",[t._v("should")]),t._v(" be limited to US-ASCII\ncharacters, per the requirements of the HTTP specification.")]),t._v(" "),s("h3",{attrs:{id:"push-streams-on-the-client"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#push-streams-on-the-client"}},[t._v("#")]),t._v(" Push streams on the client")]),t._v(" "),s("p",[t._v("To receive pushed streams on the client, set a listener for the "),s("code",[t._v("'stream'")]),t._v("\nevent on the "),s("code",[t._v("ClientHttp2Session")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nclient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("pushedStream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" requestHeaders")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  pushedStream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'push'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("responseHeaders")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Process response headers")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  pushedStream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* handle pushed data */")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" req "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"supporting-the-connect-method"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#supporting-the-connect-method"}},[t._v("#")]),t._v(" Supporting the CONNECT method")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("CONNECT")]),t._v(" method is used to allow an HTTP/2 server to be used as a proxy\nfor TCP/IP connections.")]),t._v(" "),s("p",[t._v("A simple TCP Server:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" net "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'net'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" net"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("socket")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setEncoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" chunk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("hello ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("An HTTP/2 CONNECT proxy:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NGHTTP2_REFUSED_STREAM")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constants"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" net "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'net'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" proxy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nproxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':method'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CONNECT'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Only accept CONNECT requests")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NGHTTP2_REFUSED_STREAM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" auth "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("tcp://")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':authority'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// It's a very good idea to verify that hostname and port are")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// things this proxy should be connecting to.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" socket "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" net"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("auth"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" auth"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hostname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("respond")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constants"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NGHTTP2_CONNECT_ERROR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nproxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("An HTTP/2 CONNECT client:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:8001'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Must not specify the ':path' and ':scheme' headers")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// for CONNECT requests or an error will be thrown.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" req "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':method'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CONNECT'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':authority'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("localhost:")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'response'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constants"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP2_HEADER_STATUS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setEncoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" chunk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("The server says: ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nreq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Jane'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"the-extended-connect-protocol"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-extended-connect-protocol"}},[t._v("#")]),t._v(" The Extended CONNECT Protocol")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://tools.ietf.org/html/rfc8441",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 8441"),s("OutboundLink")],1),t._v(' defines an "Extended CONNECT Protocol" extension to HTTP/2 that\nmay be used to bootstrap the use of an '),s("code",[t._v("Http2Stream")]),t._v(" using the "),s("code",[t._v("CONNECT")]),t._v("\nmethod as a tunnel for other communication protocols (such as WebSockets).")]),t._v(" "),s("p",[t._v("The use of the Extended CONNECT Protocol is enabled by HTTP/2 servers by using\nthe "),s("code",[t._v("enableConnectProtocol")]),t._v(" setting:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" settings "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" enableConnectProtocol"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" settings "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Once the client receives the "),s("code",[t._v("SETTINGS")]),t._v(" frame from the server indicating that\nthe extended CONNECT may be used, it may send "),s("code",[t._v("CONNECT")]),t._v(" requests that use the\n"),s("code",[t._v("':protocol'")]),t._v(" HTTP/2 pseudo-header:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:8080'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nclient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'remoteSettings'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("settings")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("settings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enableConnectProtocol"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" req "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':method'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CONNECT'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("':protocol'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'foo'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"compatibility-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compatibility-api"}},[t._v("#")]),t._v(" Compatibility API")]),t._v(" "),s("p",[t._v("The Compatibility API has the goal of providing a similar developer experience\nof HTTP/1 when using HTTP/2, making it possible to develop applications\nthat support both "),s("router-link",{attrs:{to:"/node/http.html"}},[t._v("HTTP/1")]),t._v(" and HTTP/2. This API targets only the\n"),s("strong",[t._v("public API")]),t._v(" of the "),s("router-link",{attrs:{to:"/node/http.html"}},[t._v("HTTP/1")]),t._v(". However many modules use internal\nmethods or state, and those "),s("em",[t._v("are not supported")]),t._v(" as it is a completely\ndifferent implementation.")],1),t._v(" "),s("p",[t._v("The following example creates an HTTP/2 server using the compatibility\nAPI:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X-Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("In order to create a mixed "),s("router-link",{attrs:{to:"/node/https.html"}},[t._v("HTTPS")]),t._v(" and HTTP/2 server, refer to the\n"),s("a",{attrs:{href:"#http2_alpn_negotiation"}},[t._v("ALPN negotiation")]),t._v(" section.\nUpgrading from non-tls HTTP/1 servers is not supported.")],1),t._v(" "),s("p",[t._v("The HTTP/2 compatibility API is composed of "),s("a",{attrs:{href:"#http2_class_http2_http2serverrequest"}},[s("code",[t._v("Http2ServerRequest")])]),t._v(" and\n"),s("a",{attrs:{href:"#class-http2http2serverresponse"}},[s("code",[t._v("Http2ServerResponse")])]),t._v(". They aim at API compatibility with HTTP/1, but\nthey do not hide the differences between the protocols. As an example,\nthe status message for HTTP codes is ignored.")]),t._v(" "),s("h3",{attrs:{id:"alpn-negotiation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#alpn-negotiation"}},[t._v("#")]),t._v(" ALPN negotiation")]),t._v(" "),s("p",[t._v("ALPN negotiation allows supporting both "),s("router-link",{attrs:{to:"/node/https.html"}},[t._v("HTTPS")]),t._v(" and HTTP/2 over\nthe same socket. The "),s("code",[t._v("req")]),t._v(" and "),s("code",[t._v("res")]),t._v(" objects can be either HTTP/1 or\nHTTP/2, and an application "),s("strong",[t._v("must")]),t._v(" restrict itself to the public API of\n"),s("router-link",{attrs:{to:"/node/http.html"}},[t._v("HTTP/1")]),t._v(", and detect if it is possible to use the more advanced\nfeatures of HTTP/2.")],1),t._v(" "),s("p",[t._v("The following example creates a server that supports both protocols:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createSecureServer "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" readFileSync "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cert "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./cert.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./key.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createSecureServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" cert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" allowHTTP1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onRequest\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4443")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Detects if it is a HTTPS request or HTTP/2")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" alpnProtocol "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("httpVersion "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2.0'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("\n    req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("session "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    alpnProtocol"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    httpVersion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("httpVersion\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("The "),s("code",[t._v("'request'")]),t._v(" event works identically on both "),s("router-link",{attrs:{to:"/node/https.html"}},[t._v("HTTPS")]),t._v(" and\nHTTP/2.")],1),t._v(" "),s("h3",{attrs:{id:"class-http2-http2serverrequest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-http2-http2serverrequest"}},[t._v("#")]),t._v(" Class: http2.Http2ServerRequest")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {stream.Readable}")])]),t._v(" "),s("p",[t._v("A "),s("code",[t._v("Http2ServerRequest")]),t._v(" object is created by "),s("a",{attrs:{href:"#http2_class_http2server"}},[s("code",[t._v("http2.Server")])]),t._v(" or\n"),s("a",{attrs:{href:"#http2_class_http2secureserver"}},[s("code",[t._v("http2.SecureServer")])]),t._v(" and passed as the first argument to the\n"),s("a",{attrs:{href:"#http2_event_request"}},[s("code",[t._v("'request'")])]),t._v(" event. It may be used to access a request status, headers, and\ndata.")]),t._v(" "),s("h4",{attrs:{id:"event-aborted-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-aborted-2"}},[t._v("#")]),t._v(" Event: 'aborted'")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'aborted'")]),t._v(" event is emitted whenever a "),s("code",[t._v("Http2ServerRequest")]),t._v(" instance is\nabnormally aborted in mid-communication.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("'aborted'")]),t._v(" event will only be emitted if the "),s("code",[t._v("Http2ServerRequest")]),t._v(" writable\nside has not been ended.")]),t._v(" "),s("h4",{attrs:{id:"event-close-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-close-3"}},[t._v("#")]),t._v(" Event: 'close'")]),t._v(" "),s("p",[t._v("Indicates that the underlying "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v(" was closed.\nJust like "),s("code",[t._v("'end'")]),t._v(", this event occurs only once per response.")]),t._v(" "),s("h4",{attrs:{id:"request-aborted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-aborted"}},[t._v("#")]),t._v(" request.aborted")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("request.aborted")]),t._v(" property will be "),s("code",[t._v("true")]),t._v(" if the request has\nbeen aborted.")]),t._v(" "),s("h4",{attrs:{id:"request-authority"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-authority"}},[t._v("#")]),t._v(" request.authority")]),t._v(" "),s("ul",[s("li",[t._v("{string}")])]),t._v(" "),s("p",[t._v("The request authority pseudo header field. It can also be accessed via\n"),s("code",[t._v("req.headers[':authority']")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"request-complete"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-complete"}},[t._v("#")]),t._v(" request.complete")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("request.complete")]),t._v(" property will be "),s("code",[t._v("true")]),t._v(" if the request has\nbeen completed, aborted, or destroyed.")]),t._v(" "),s("h4",{attrs:{id:"request-connection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-connection"}},[t._v("#")]),t._v(" request.connection")]),t._v(" "),s("blockquote",[s("p",[t._v("Stability: 0 - Deprecated. Use "),s("a",{attrs:{href:"#http2_request_socket"}},[s("code",[t._v("request.socket")])]),t._v(".")])]),t._v(" "),s("ul",[s("li",[t._v("{net.Socket|tls.TLSSocket}")])]),t._v(" "),s("p",[t._v("See "),s("a",{attrs:{href:"#http2_request_socket"}},[s("code",[t._v("request.socket")])]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"request-destroy-error"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-destroy-error"}},[t._v("#")]),t._v(" request.destroy([error])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("error")]),t._v(" {Error}")])]),t._v(" "),s("p",[t._v("Calls "),s("code",[t._v("destroy()")]),t._v(" on the "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v(" that received\nthe "),s("a",{attrs:{href:"#http2_class_http2_http2serverrequest"}},[s("code",[t._v("Http2ServerRequest")])]),t._v(". If "),s("code",[t._v("error")]),t._v(" is provided, an "),s("code",[t._v("'error'")]),t._v(" event\nis emitted and "),s("code",[t._v("error")]),t._v(" is passed as an argument to any listeners on the event.")]),t._v(" "),s("p",[t._v("It does nothing if the stream was already destroyed.")]),t._v(" "),s("h4",{attrs:{id:"request-headers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-headers"}},[t._v("#")]),t._v(" request.headers")]),t._v(" "),s("ul",[s("li",[t._v("{Object}")])]),t._v(" "),s("p",[t._v("The request/response headers object.")]),t._v(" "),s("p",[t._v("Key-value pairs of header names and values. Header names are lower-cased.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Prints something like:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// { 'user-agent': 'curl/7.22.0',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   host: '127.0.0.1:8000',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   accept: '*/*' }")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("See "),s("a",{attrs:{href:"#http2_headers_object"}},[t._v("HTTP/2 Headers Object")]),t._v(".")]),t._v(" "),s("p",[t._v("In HTTP/2, the request path, hostname, protocol, and method are represented as\nspecial headers prefixed with the "),s("code",[t._v(":")]),t._v(" character (e.g. "),s("code",[t._v("':path'")]),t._v("). These special\nheaders will be included in the "),s("code",[t._v("request.headers")]),t._v(" object. Care must be taken not\nto inadvertently modify these special headers or errors may occur. For instance,\nremoving all headers from the request will cause errors to occur:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeAllHeaders")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("assert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Fails because the :path header has been removed")]),t._v("\n")])])]),s("h4",{attrs:{id:"request-httpversion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-httpversion"}},[t._v("#")]),t._v(" request.httpVersion")]),t._v(" "),s("ul",[s("li",[t._v("{string}")])]),t._v(" "),s("p",[t._v("In case of server request, the HTTP version sent by the client. In the case of\nclient response, the HTTP version of the connected-to server. Returns\n"),s("code",[t._v("'2.0'")]),t._v(".")]),t._v(" "),s("p",[t._v("Also "),s("code",[t._v("message.httpVersionMajor")]),t._v(" is the first integer and\n"),s("code",[t._v("message.httpVersionMinor")]),t._v(" is the second.")]),t._v(" "),s("h4",{attrs:{id:"request-method"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-method"}},[t._v("#")]),t._v(" request.method")]),t._v(" "),s("ul",[s("li",[t._v("{string}")])]),t._v(" "),s("p",[t._v("The request method as a string. Read-only. Examples: "),s("code",[t._v("'GET'")]),t._v(", "),s("code",[t._v("'DELETE'")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"request-rawheaders"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-rawheaders"}},[t._v("#")]),t._v(" request.rawHeaders")]),t._v(" "),s("ul",[s("li",[t._v("{string[]}")])]),t._v(" "),s("p",[t._v("The raw request/response headers list exactly as they were received.")]),t._v(" "),s("p",[t._v("The keys and values are in the same list. It is "),s("em",[t._v("not")]),t._v(" a\nlist of tuples. So, the even-numbered offsets are key values, and the\nodd-numbered offsets are the associated values.")]),t._v(" "),s("p",[t._v("Header names are not lowercased, and duplicates are not merged.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Prints something like:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [ 'user-agent',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   'this is invalid because there can be only one',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   'User-Agent',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   'curl/7.22.0',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   'Host',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   '127.0.0.1:8000',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   'ACCEPT',")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   '*/*' ]")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rawHeaders"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"request-rawtrailers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-rawtrailers"}},[t._v("#")]),t._v(" request.rawTrailers")]),t._v(" "),s("ul",[s("li",[t._v("{string[]}")])]),t._v(" "),s("p",[t._v("The raw request/response trailer keys and values exactly as they were\nreceived. Only populated at the "),s("code",[t._v("'end'")]),t._v(" event.")]),t._v(" "),s("h4",{attrs:{id:"request-scheme"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-scheme"}},[t._v("#")]),t._v(" request.scheme")]),t._v(" "),s("ul",[s("li",[t._v("{string}")])]),t._v(" "),s("p",[t._v("The request scheme pseudo header field indicating the scheme\nportion of the target URL.")]),t._v(" "),s("h4",{attrs:{id:"request-settimeout-msecs-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-settimeout-msecs-callback"}},[t._v("#")]),t._v(" request.setTimeout(msecs, callback)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("msecs")]),t._v(" {number}")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")]),t._v(" "),s("li",[t._v("Returns: {http2.Http2ServerRequest}")])]),t._v(" "),s("p",[t._v("Sets the "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v("'s timeout value to "),s("code",[t._v("msecs")]),t._v(". If a callback is\nprovided, then it is added as a listener on the "),s("code",[t._v("'timeout'")]),t._v(" event on\nthe response object.")]),t._v(" "),s("p",[t._v("If no "),s("code",[t._v("'timeout'")]),t._v(" listener is added to the request, the response, or\nthe server, then "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v("s are destroyed when they time out. If a\nhandler is assigned to the request, the response, or the server's "),s("code",[t._v("'timeout'")]),t._v("\nevents, timed out sockets must be handled explicitly.")]),t._v(" "),s("h4",{attrs:{id:"request-socket"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-socket"}},[t._v("#")]),t._v(" request.socket")]),t._v(" "),s("ul",[s("li",[t._v("{net.Socket|tls.TLSSocket}")])]),t._v(" "),s("p",[t._v("Returns a "),s("code",[t._v("Proxy")]),t._v(" object that acts as a "),s("code",[t._v("net.Socket")]),t._v(" (or "),s("code",[t._v("tls.TLSSocket")]),t._v(") but\napplies getters, setters, and methods based on HTTP/2 logic.")]),t._v(" "),s("p",[s("code",[t._v("destroyed")]),t._v(", "),s("code",[t._v("readable")]),t._v(", and "),s("code",[t._v("writable")]),t._v(" properties will be retrieved from and\nset on "),s("code",[t._v("request.stream")]),t._v(".")]),t._v(" "),s("p",[s("code",[t._v("destroy")]),t._v(", "),s("code",[t._v("emit")]),t._v(", "),s("code",[t._v("end")]),t._v(", "),s("code",[t._v("on")]),t._v(" and "),s("code",[t._v("once")]),t._v(" methods will be called on\n"),s("code",[t._v("request.stream")]),t._v(".")]),t._v(" "),s("p",[s("code",[t._v("setTimeout")]),t._v(" method will be called on "),s("code",[t._v("request.stream.session")]),t._v(".")]),t._v(" "),s("p",[s("code",[t._v("pause")]),t._v(", "),s("code",[t._v("read")]),t._v(", "),s("code",[t._v("resume")]),t._v(", and "),s("code",[t._v("write")]),t._v(" will throw an error with code\n"),s("code",[t._v("ERR_HTTP2_NO_SOCKET_MANIPULATION")]),t._v(". See "),s("a",{attrs:{href:"#http2_http2session_and_sockets"}},[s("code",[t._v("Http2Session")]),t._v(" and Sockets")]),t._v(" for\nmore information.")]),t._v(" "),s("p",[t._v("All other interactions will be routed directly to the socket. With TLS support,\nuse "),s("router-link",{attrs:{to:"/node/tls.html#tls_tlssocket_getpeercertificate_detailed"}},[s("code",[t._v("request.socket.getPeerCertificate()")])]),t._v(" to obtain the client's\nauthentication details.")],1),t._v(" "),s("h4",{attrs:{id:"request-stream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-stream"}},[t._v("#")]),t._v(" request.stream")]),t._v(" "),s("ul",[s("li",[t._v("{Http2Stream}")])]),t._v(" "),s("p",[t._v("The "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v(" object backing the request.")]),t._v(" "),s("h4",{attrs:{id:"request-trailers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-trailers"}},[t._v("#")]),t._v(" request.trailers")]),t._v(" "),s("ul",[s("li",[t._v("{Object}")])]),t._v(" "),s("p",[t._v("The request/response trailers object. Only populated at the "),s("code",[t._v("'end'")]),t._v(" event.")]),t._v(" "),s("h4",{attrs:{id:"request-url"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-url"}},[t._v("#")]),t._v(" request.url")]),t._v(" "),s("ul",[s("li",[t._v("{string}")])]),t._v(" "),s("p",[t._v("Request URL string. This contains only the URL that is\npresent in the actual HTTP request. If the request is:")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("GET /status?name=ryan HTTP/1.1\\r\\n\nAccept: text/plain\\r\\n\n\\r\\n\n")])])]),s("p",[t._v("Then "),s("code",[t._v("request.url")]),t._v(" will be:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/status?name=ryan'")]),t._v("\n")])])]),s("p",[t._v("To parse the url into its parts "),s("code",[t._v("require('url').parse(request.url)")]),t._v("\ncan be used:")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ node\n> require('url').parse('/status?name=ryan')\nUrl {\n  protocol: null,\n  slashes: null,\n  auth: null,\n  host: null,\n  port: null,\n  hostname: null,\n  hash: null,\n  search: '?name=ryan',\n  query: 'name=ryan',\n  pathname: '/status',\n  path: '/status?name=ryan',\n  href: '/status?name=ryan' }\n")])])]),s("p",[t._v("To extract the parameters from the query string, the\n"),s("code",[t._v("require('querystring').parse")]),t._v(" function can be used, or\n"),s("code",[t._v("true")]),t._v(" can be passed as the second argument to "),s("code",[t._v("require('url').parse")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-console extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ node\n> require('url').parse('/status?name=ryan', true)\nUrl {\n  protocol: null,\n  slashes: null,\n  auth: null,\n  host: null,\n  port: null,\n  hostname: null,\n  hash: null,\n  search: '?name=ryan',\n  query: { name: 'ryan' },\n  pathname: '/status',\n  path: '/status?name=ryan',\n  href: '/status?name=ryan' }\n")])])]),s("h3",{attrs:{id:"class-http2-http2serverresponse"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-http2-http2serverresponse"}},[t._v("#")]),t._v(" Class: http2.Http2ServerResponse")]),t._v(" "),s("ul",[s("li",[t._v("Extends: {Stream}")])]),t._v(" "),s("p",[t._v("This object is created internally by an HTTP server — not by the user. It is\npassed as the second parameter to the "),s("a",{attrs:{href:"#http2_event_request"}},[s("code",[t._v("'request'")])]),t._v(" event.")]),t._v(" "),s("h4",{attrs:{id:"event-close-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-close-4"}},[t._v("#")]),t._v(" Event: 'close'")]),t._v(" "),s("p",[t._v("Indicates that the underlying "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v(" was terminated before\n"),s("a",{attrs:{href:"#http2_response_end_data_encoding_callback"}},[s("code",[t._v("response.end()")])]),t._v(" was called or able to flush.")]),t._v(" "),s("h4",{attrs:{id:"event-finish"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-finish"}},[t._v("#")]),t._v(" Event: 'finish'")]),t._v(" "),s("p",[t._v("Emitted when the response has been sent. More specifically, this event is\nemitted when the last segment of the response headers and body have been\nhanded off to the HTTP/2 multiplexing for transmission over the network. It\ndoes not imply that the client has received anything yet.")]),t._v(" "),s("p",[t._v("After this event, no more events will be emitted on the response object.")]),t._v(" "),s("h4",{attrs:{id:"response-addtrailers-headers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-addtrailers-headers"}},[t._v("#")]),t._v(" response.addTrailers(headers)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("headers")]),t._v(" {Object}")])]),t._v(" "),s("p",[t._v("This method adds HTTP trailing headers (a header but at the end of the\nmessage) to the response.")]),t._v(" "),s("p",[t._v("Attempting to set a header field name or value that contains invalid characters\nwill result in a "),s("router-link",{attrs:{to:"/node/errors.html#errors_class_typeerror"}},[s("code",[t._v("TypeError")])]),t._v(" being thrown.")],1),t._v(" "),s("h4",{attrs:{id:"response-connection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-connection"}},[t._v("#")]),t._v(" response.connection")]),t._v(" "),s("blockquote",[s("p",[t._v("Stability: 0 - Deprecated. Use "),s("a",{attrs:{href:"#http2_response_socket"}},[s("code",[t._v("response.socket")])]),t._v(".")])]),t._v(" "),s("ul",[s("li",[t._v("{net.Socket|tls.TLSSocket}")])]),t._v(" "),s("p",[t._v("See "),s("a",{attrs:{href:"#http2_response_socket"}},[s("code",[t._v("response.socket")])]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"response-end-data-encoding-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-end-data-encoding-callback"}},[t._v("#")]),t._v(" response.end([data[, encoding]][, callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("data")]),t._v(" {string|Buffer}")]),t._v(" "),s("li",[s("code",[t._v("encoding")]),t._v(" {string}")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")]),t._v(" "),s("li",[t._v("Returns: {this}")])]),t._v(" "),s("p",[t._v("This method signals to the server that all of the response headers and body\nhave been sent; that server should consider this message complete.\nThe method, "),s("code",[t._v("response.end()")]),t._v(", MUST be called on each response.")]),t._v(" "),s("p",[t._v("If "),s("code",[t._v("data")]),t._v(" is specified, it is equivalent to calling\n"),s("router-link",{attrs:{to:"/node/http.html#http_response_write_chunk_encoding_callback"}},[s("code",[t._v("response.write(data, encoding)")])]),t._v(" followed by "),s("code",[t._v("response.end(callback)")]),t._v(".")],1),t._v(" "),s("p",[t._v("If "),s("code",[t._v("callback")]),t._v(" is specified, it will be called when the response stream\nis finished.")]),t._v(" "),s("h4",{attrs:{id:"response-finished"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-finished"}},[t._v("#")]),t._v(" response.finished")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Boolean value that indicates whether the response has completed. Starts\nas "),s("code",[t._v("false")]),t._v(". After "),s("a",{attrs:{href:"#http2_response_end_data_encoding_callback"}},[s("code",[t._v("response.end()")])]),t._v(" executes, the value will be "),s("code",[t._v("true")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"response-getheader-name"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-getheader-name"}},[t._v("#")]),t._v(" response.getHeader(name)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("name")]),t._v(" {string}")]),t._v(" "),s("li",[t._v("Returns: {string}")])]),t._v(" "),s("p",[t._v("Reads out a header that has already been queued but not sent to the client.\nThe name is case-insensitive.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" contentType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"response-getheadernames"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-getheadernames"}},[t._v("#")]),t._v(" response.getHeaderNames()")]),t._v(" "),s("ul",[s("li",[t._v("Returns: {string[]}")])]),t._v(" "),s("p",[t._v("Returns an array containing the unique names of the current outgoing headers.\nAll header names are lowercase.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nresponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Set-Cookie'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'foo=bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar=baz'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" headerNames "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getHeaderNames")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// headerNames === ['foo', 'set-cookie']")]),t._v("\n")])])]),s("h4",{attrs:{id:"response-getheaders"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-getheaders"}},[t._v("#")]),t._v(" response.getHeaders()")]),t._v(" "),s("ul",[s("li",[t._v("Returns: {Object}")])]),t._v(" "),s("p",[t._v("Returns a shallow copy of the current outgoing headers. Since a shallow copy\nis used, array values may be mutated without additional calls to various\nheader-related http module methods. The keys of the returned object are the\nheader names and the values are the respective header values. All header names\nare lowercase.")]),t._v(" "),s("p",[t._v("The object returned by the "),s("code",[t._v("response.getHeaders()")]),t._v(" method "),s("em",[t._v("does not")]),t._v("\nprototypically inherit from the JavaScript "),s("code",[t._v("Object")]),t._v(". This means that typical\n"),s("code",[t._v("Object")]),t._v(" methods such as "),s("code",[t._v("obj.toString()")]),t._v(", "),s("code",[t._v("obj.hasOwnProperty()")]),t._v(", and others\nare not defined and "),s("em",[t._v("will not work")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nresponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Set-Cookie'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'foo=bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar=baz'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" headers "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getHeaders")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// headers === { foo: 'bar', 'set-cookie': ['foo=bar', 'bar=baz'] }")]),t._v("\n")])])]),s("h4",{attrs:{id:"response-hasheader-name"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-hasheader-name"}},[t._v("#")]),t._v(" response.hasHeader(name)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("name")]),t._v(" {string}")]),t._v(" "),s("li",[t._v("Returns: {boolean}")])]),t._v(" "),s("p",[t._v("Returns "),s("code",[t._v("true")]),t._v(" if the header identified by "),s("code",[t._v("name")]),t._v(" is currently set in the\noutgoing headers. The header name matching is case-insensitive.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hasContentType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"response-headerssent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-headerssent"}},[t._v("#")]),t._v(" response.headersSent")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("True if headers were sent, false otherwise (read-only).")]),t._v(" "),s("h4",{attrs:{id:"response-removeheader-name"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-removeheader-name"}},[t._v("#")]),t._v(" response.removeHeader(name)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("name")]),t._v(" {string}")])]),t._v(" "),s("p",[t._v("Removes a header that has been queued for implicit sending.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Encoding'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"response-senddate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-senddate"}},[t._v("#")]),t._v(" response.sendDate")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("When true, the Date header will be automatically generated and sent in\nthe response if it is not already present in the headers. Defaults to true.")]),t._v(" "),s("p",[t._v("This should only be disabled for testing; HTTP requires the Date header\nin responses.")]),t._v(" "),s("h4",{attrs:{id:"response-setheader-name-value"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-setheader-name-value"}},[t._v("#")]),t._v(" response.setHeader(name, value)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("name")]),t._v(" {string}")]),t._v(" "),s("li",[s("code",[t._v("value")]),t._v(" {string|string[]}")])]),t._v(" "),s("p",[t._v("Sets a single header value for implicit headers. If this header already exists\nin the to-be-sent headers, its value will be replaced. Use an array of strings\nhere to send multiple headers with the same name.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("or")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Set-Cookie'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'type=ninja'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'language=javascript'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Attempting to set a header field name or value that contains invalid characters\nwill result in a "),s("router-link",{attrs:{to:"/node/errors.html#errors_class_typeerror"}},[s("code",[t._v("TypeError")])]),t._v(" being thrown.")],1),t._v(" "),s("p",[t._v("When headers have been set with "),s("a",{attrs:{href:"#http2_response_setheader_name_value"}},[s("code",[t._v("response.setHeader()")])]),t._v(", they will be merged\nwith any headers passed to "),s("a",{attrs:{href:"#http2_response_writehead_statuscode_statusmessage_headers"}},[s("code",[t._v("response.writeHead()")])]),t._v(", with the headers passed\nto "),s("a",{attrs:{href:"#http2_response_writehead_statuscode_statusmessage_headers"}},[s("code",[t._v("response.writeHead()")])]),t._v(" given precedence.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Returns content-type = text/plain")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X-Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"response-settimeout-msecs-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-settimeout-msecs-callback"}},[t._v("#")]),t._v(" response.setTimeout(msecs[, callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("msecs")]),t._v(" {number}")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")]),t._v(" "),s("li",[t._v("Returns: {http2.Http2ServerResponse}")])]),t._v(" "),s("p",[t._v("Sets the "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v("'s timeout value to "),s("code",[t._v("msecs")]),t._v(". If a callback is\nprovided, then it is added as a listener on the "),s("code",[t._v("'timeout'")]),t._v(" event on\nthe response object.")]),t._v(" "),s("p",[t._v("If no "),s("code",[t._v("'timeout'")]),t._v(" listener is added to the request, the response, or\nthe server, then "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v("s are destroyed when they time out. If a\nhandler is assigned to the request, the response, or the server's "),s("code",[t._v("'timeout'")]),t._v("\nevents, timed out sockets must be handled explicitly.")]),t._v(" "),s("h4",{attrs:{id:"response-socket"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-socket"}},[t._v("#")]),t._v(" response.socket")]),t._v(" "),s("ul",[s("li",[t._v("{net.Socket|tls.TLSSocket}")])]),t._v(" "),s("p",[t._v("Returns a "),s("code",[t._v("Proxy")]),t._v(" object that acts as a "),s("code",[t._v("net.Socket")]),t._v(" (or "),s("code",[t._v("tls.TLSSocket")]),t._v(") but\napplies getters, setters, and methods based on HTTP/2 logic.")]),t._v(" "),s("p",[s("code",[t._v("destroyed")]),t._v(", "),s("code",[t._v("readable")]),t._v(", and "),s("code",[t._v("writable")]),t._v(" properties will be retrieved from and\nset on "),s("code",[t._v("response.stream")]),t._v(".")]),t._v(" "),s("p",[s("code",[t._v("destroy")]),t._v(", "),s("code",[t._v("emit")]),t._v(", "),s("code",[t._v("end")]),t._v(", "),s("code",[t._v("on")]),t._v(" and "),s("code",[t._v("once")]),t._v(" methods will be called on\n"),s("code",[t._v("response.stream")]),t._v(".")]),t._v(" "),s("p",[s("code",[t._v("setTimeout")]),t._v(" method will be called on "),s("code",[t._v("response.stream.session")]),t._v(".")]),t._v(" "),s("p",[s("code",[t._v("pause")]),t._v(", "),s("code",[t._v("read")]),t._v(", "),s("code",[t._v("resume")]),t._v(", and "),s("code",[t._v("write")]),t._v(" will throw an error with code\n"),s("code",[t._v("ERR_HTTP2_NO_SOCKET_MANIPULATION")]),t._v(". See "),s("a",{attrs:{href:"#http2_http2session_and_sockets"}},[s("code",[t._v("Http2Session")]),t._v(" and Sockets")]),t._v(" for\nmore information.")]),t._v(" "),s("p",[t._v("All other interactions will be routed directly to the socket.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ip "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remoteAddress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" port "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remotePort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Your IP address is ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("ip"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" and your source port is ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"response-statuscode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-statuscode"}},[t._v("#")]),t._v(" response.statusCode")]),t._v(" "),s("ul",[s("li",[t._v("{number}")])]),t._v(" "),s("p",[t._v("When using implicit headers (not calling "),s("a",{attrs:{href:"#http2_response_writehead_statuscode_statusmessage_headers"}},[s("code",[t._v("response.writeHead()")])]),t._v(" explicitly),\nthis property controls the status code that will be sent to the client when\nthe headers get flushed.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("statusCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("After response header was sent to the client, this property indicates the\nstatus code which was sent out.")]),t._v(" "),s("h4",{attrs:{id:"response-statusmessage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-statusmessage"}},[t._v("#")]),t._v(" response.statusMessage")]),t._v(" "),s("ul",[s("li",[t._v("{string}")])]),t._v(" "),s("p",[t._v("Status message is not supported by HTTP/2 (RFC 7540 8.1.2.4). It returns\nan empty string.")]),t._v(" "),s("h4",{attrs:{id:"response-stream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-stream"}},[t._v("#")]),t._v(" response.stream")]),t._v(" "),s("ul",[s("li",[t._v("{Http2Stream}")])]),t._v(" "),s("p",[t._v("The "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v(" object backing the response.")]),t._v(" "),s("h4",{attrs:{id:"response-writableended"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-writableended"}},[t._v("#")]),t._v(" response.writableEnded")]),t._v(" "),s("ul",[s("li",[t._v("{boolean}")])]),t._v(" "),s("p",[t._v("Is "),s("code",[t._v("true")]),t._v(" after "),s("a",{attrs:{href:"#http2_response_end_data_encoding_callback"}},[s("code",[t._v("response.end()")])]),t._v(" has been called. This property\ndoes not indicate whether the data has been flushed, for this use\n"),s("router-link",{attrs:{to:"/node/stream.html#stream_writable_writablefinished"}},[s("code",[t._v("writable.writableFinished")])]),t._v(" instead.")],1),t._v(" "),s("h4",{attrs:{id:"response-write-chunk-encoding-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-write-chunk-encoding-callback"}},[t._v("#")]),t._v(" response.write(chunk[, encoding][, callback])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("chunk")]),t._v(" {string|Buffer}")]),t._v(" "),s("li",[s("code",[t._v("encoding")]),t._v(" {string}")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function}")]),t._v(" "),s("li",[t._v("Returns: {boolean}")])]),t._v(" "),s("p",[t._v("If this method is called and "),s("a",{attrs:{href:"#http2_response_writehead_statuscode_statusmessage_headers"}},[s("code",[t._v("response.writeHead()")])]),t._v(" has not been called,\nit will switch to implicit header mode and flush the implicit headers.")]),t._v(" "),s("p",[t._v("This sends a chunk of the response body. This method may\nbe called multiple times to provide successive parts of the body.")]),t._v(" "),s("p",[t._v("In the "),s("code",[t._v("http")]),t._v(" module, the response body is omitted when the\nrequest is a HEAD request. Similarly, the "),s("code",[t._v("204")]),t._v(" and "),s("code",[t._v("304")]),t._v(" responses\n"),s("em",[t._v("must not")]),t._v(" include a message body.")]),t._v(" "),s("p",[s("code",[t._v("chunk")]),t._v(" can be a string or a buffer. If "),s("code",[t._v("chunk")]),t._v(" is a string,\nthe second parameter specifies how to encode it into a byte stream.\nBy default the "),s("code",[t._v("encoding")]),t._v(" is "),s("code",[t._v("'utf8'")]),t._v(". "),s("code",[t._v("callback")]),t._v(" will be called when this chunk\nof data is flushed.")]),t._v(" "),s("p",[t._v("This is the raw HTTP body and has nothing to do with higher-level multi-part\nbody encodings that may be used.")]),t._v(" "),s("p",[t._v("The first time "),s("a",{attrs:{href:"#http2_response_write_chunk_encoding_callback"}},[s("code",[t._v("response.write()")])]),t._v(" is called, it will send the buffered\nheader information and the first chunk of the body to the client. The second\ntime "),s("a",{attrs:{href:"#http2_response_write_chunk_encoding_callback"}},[s("code",[t._v("response.write()")])]),t._v(" is called, Node.js assumes data will be streamed,\nand sends the new data separately. That is, the response is buffered up to the\nfirst chunk of the body.")]),t._v(" "),s("p",[t._v("Returns "),s("code",[t._v("true")]),t._v(" if the entire data was flushed successfully to the kernel\nbuffer. Returns "),s("code",[t._v("false")]),t._v(" if all or part of the data was queued in user memory.\n"),s("code",[t._v("'drain'")]),t._v(" will be emitted when the buffer is free again.")]),t._v(" "),s("h4",{attrs:{id:"response-writecontinue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-writecontinue"}},[t._v("#")]),t._v(" response.writeContinue()")]),t._v(" "),s("p",[t._v("Sends a status "),s("code",[t._v("100 Continue")]),t._v(" to the client, indicating that the request body\nshould be sent. See the "),s("a",{attrs:{href:"#http2_event_checkcontinue"}},[s("code",[t._v("'checkContinue'")])]),t._v(" event on "),s("code",[t._v("Http2Server")]),t._v(" and\n"),s("code",[t._v("Http2SecureServer")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"response-writehead-statuscode-statusmessage-headers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-writehead-statuscode-statusmessage-headers"}},[t._v("#")]),t._v(" response.writeHead(statusCode[, statusMessage][, headers])")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("statusCode")]),t._v(" {number}")]),t._v(" "),s("li",[s("code",[t._v("statusMessage")]),t._v(" {string}")]),t._v(" "),s("li",[s("code",[t._v("headers")]),t._v(" {Object}")]),t._v(" "),s("li",[t._v("Returns: {http2.Http2ServerResponse}")])]),t._v(" "),s("p",[t._v("Sends a response header to the request. The status code is a 3-digit HTTP\nstatus code, like "),s("code",[t._v("404")]),t._v(". The last argument, "),s("code",[t._v("headers")]),t._v(", are the response headers.")]),t._v(" "),s("p",[t._v("Returns a reference to the "),s("code",[t._v("Http2ServerResponse")]),t._v(", so that calls can be chained.")]),t._v(" "),s("p",[t._v("For compatibility with "),s("router-link",{attrs:{to:"/node/http.html"}},[t._v("HTTP/1")]),t._v(", a human-readable "),s("code",[t._v("statusMessage")]),t._v(" may be\npassed as the second argument. However, because the "),s("code",[t._v("statusMessage")]),t._v(" has no\nmeaning within HTTP/2, the argument will have no effect and a process warning\nwill be emitted.")],1),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nresponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Length'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Buffer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("byteLength")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[s("code",[t._v("Content-Length")]),t._v(" is given in bytes not characters. The\n"),s("code",[t._v("Buffer.byteLength()")]),t._v(" API may be used to determine the number of bytes in a\ngiven encoding. On outbound messages, Node.js does not check if Content-Length\nand the length of the body being transmitted are equal or not. However, when\nreceiving messages, Node.js will automatically reject messages when the\n"),s("code",[t._v("Content-Length")]),t._v(" does not match the actual payload size.")]),t._v(" "),s("p",[t._v("This method may be called at most one time on a message before\n"),s("a",{attrs:{href:"#http2_response_end_data_encoding_callback"}},[s("code",[t._v("response.end()")])]),t._v(" is called.")]),t._v(" "),s("p",[t._v("If "),s("a",{attrs:{href:"#http2_response_write_chunk_encoding_callback"}},[s("code",[t._v("response.write()")])]),t._v(" or "),s("a",{attrs:{href:"#http2_response_end_data_encoding_callback"}},[s("code",[t._v("response.end()")])]),t._v(" are called before calling\nthis, the implicit/mutable headers will be calculated and call this function.")]),t._v(" "),s("p",[t._v("When headers have been set with "),s("a",{attrs:{href:"#http2_response_setheader_name_value"}},[s("code",[t._v("response.setHeader()")])]),t._v(", they will be merged\nwith any headers passed to "),s("a",{attrs:{href:"#http2_response_writehead_statuscode_statusmessage_headers"}},[s("code",[t._v("response.writeHead()")])]),t._v(", with the headers passed\nto "),s("a",{attrs:{href:"#http2_response_writehead_statuscode_statusmessage_headers"}},[s("code",[t._v("response.writeHead()")])]),t._v(" given precedence.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Returns content-type = text/plain")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X-Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Attempting to set a header field name or value that contains invalid characters\nwill result in a "),s("router-link",{attrs:{to:"/node/errors.html#errors_class_typeerror"}},[s("code",[t._v("TypeError")])]),t._v(" being thrown.")],1),t._v(" "),s("h4",{attrs:{id:"response-createpushresponse-headers-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response-createpushresponse-headers-callback"}},[t._v("#")]),t._v(" response.createPushResponse(headers, callback)")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("headers")]),t._v(" {HTTP/2 Headers Object} An object describing the headers")]),t._v(" "),s("li",[s("code",[t._v("callback")]),t._v(" {Function} Called once "),s("code",[t._v("http2stream.pushStream()")]),t._v(" is finished,\nor either when the attempt to create the pushed "),s("code",[t._v("Http2Stream")]),t._v(" has failed or\nhas been rejected, or the state of "),s("code",[t._v("Http2ServerRequest")]),t._v(" is closed prior to\ncalling the "),s("code",[t._v("http2stream.pushStream()")]),t._v(" method\n"),s("ul",[s("li",[s("code",[t._v("err")]),t._v(" {Error}")]),t._v(" "),s("li",[s("code",[t._v("stream")]),t._v(" {ServerHttp2Stream} The newly-created "),s("code",[t._v("ServerHttp2Stream")]),t._v(" object")])])])]),t._v(" "),s("p",[t._v("Call "),s("a",{attrs:{href:"#http2_http2stream_pushstream_headers_options_callback"}},[s("code",[t._v("http2stream.pushStream()")])]),t._v(" with the given headers, and wrap the\ngiven "),s("a",{attrs:{href:"#http2_class_http2stream"}},[s("code",[t._v("Http2Stream")])]),t._v(" on a newly created "),s("code",[t._v("Http2ServerResponse")]),t._v(" as the callback\nparameter if successful. When "),s("code",[t._v("Http2ServerRequest")]),t._v(" is closed, the callback is\ncalled with an error "),s("code",[t._v("ERR_HTTP2_INVALID_STREAM")]),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"collecting-http-2-performance-metrics"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#collecting-http-2-performance-metrics"}},[t._v("#")]),t._v(" Collecting HTTP/2 Performance Metrics")]),t._v(" "),s("p",[t._v("The "),s("router-link",{attrs:{to:"/node/perf_hooks.html"}},[t._v("Performance Observer")]),t._v(" API can be used to collect basic performance\nmetrics for each "),s("code",[t._v("Http2Session")]),t._v(" and "),s("code",[t._v("Http2Stream")]),t._v(" instance.")],1),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" PerformanceObserver "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'perf_hooks'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" obs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PerformanceObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("items")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entry "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntries")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entryType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// prints 'http2'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Http2Session'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Entry contains statistics about the Http2Session")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Http2Stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Entry contains statistics about the Http2Stream")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nobs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" entryTypes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("The "),s("code",[t._v("entryType")]),t._v(" property of the "),s("code",[t._v("PerformanceEntry")]),t._v(" will be equal to "),s("code",[t._v("'http2'")]),t._v(".")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("name")]),t._v(" property of the "),s("code",[t._v("PerformanceEntry")]),t._v(" will be equal to either\n"),s("code",[t._v("'Http2Stream'")]),t._v(" or "),s("code",[t._v("'Http2Session'")]),t._v(".")]),t._v(" "),s("p",[t._v("If "),s("code",[t._v("name")]),t._v(" is equal to "),s("code",[t._v("Http2Stream")]),t._v(", the "),s("code",[t._v("PerformanceEntry")]),t._v(" will contain the\nfollowing additional properties:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("bytesRead")]),t._v(" {number} The number of "),s("code",[t._v("DATA")]),t._v(" frame bytes received for this\n"),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("bytesWritten")]),t._v(" {number} The number of "),s("code",[t._v("DATA")]),t._v(" frame bytes sent for this\n"),s("code",[t._v("Http2Stream")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("id")]),t._v(" {number} The identifier of the associated "),s("code",[t._v("Http2Stream")])]),t._v(" "),s("li",[s("code",[t._v("timeToFirstByte")]),t._v(" {number} The number of milliseconds elapsed between the\n"),s("code",[t._v("PerformanceEntry")]),t._v(" "),s("code",[t._v("startTime")]),t._v(" and the reception of the first "),s("code",[t._v("DATA")]),t._v(" frame.")]),t._v(" "),s("li",[s("code",[t._v("timeToFirstByteSent")]),t._v(" {number} The number of milliseconds elapsed between\nthe "),s("code",[t._v("PerformanceEntry")]),t._v(" "),s("code",[t._v("startTime")]),t._v(" and sending of the first "),s("code",[t._v("DATA")]),t._v(" frame.")]),t._v(" "),s("li",[s("code",[t._v("timeToFirstHeader")]),t._v(" {number} The number of milliseconds elapsed between the\n"),s("code",[t._v("PerformanceEntry")]),t._v(" "),s("code",[t._v("startTime")]),t._v(" and the reception of the first header.")])]),t._v(" "),s("p",[t._v("If "),s("code",[t._v("name")]),t._v(" is equal to "),s("code",[t._v("Http2Session")]),t._v(", the "),s("code",[t._v("PerformanceEntry")]),t._v(" will contain the\nfollowing additional properties:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("bytesRead")]),t._v(" {number} The number of bytes received for this "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("bytesWritten")]),t._v(" {number} The number of bytes sent for this "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("framesReceived")]),t._v(" {number} The number of HTTP/2 frames received by the\n"),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("framesSent")]),t._v(" {number} The number of HTTP/2 frames sent by the "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("maxConcurrentStreams")]),t._v(" {number} The maximum number of streams concurrently\nopen during the lifetime of the "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("pingRTT")]),t._v(" {number} The number of milliseconds elapsed since the transmission\nof a "),s("code",[t._v("PING")]),t._v(" frame and the reception of its acknowledgment. Only present if\na "),s("code",[t._v("PING")]),t._v(" frame has been sent on the "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("streamAverageDuration")]),t._v(" {number} The average duration (in milliseconds) for\nall "),s("code",[t._v("Http2Stream")]),t._v(" instances.")]),t._v(" "),s("li",[s("code",[t._v("streamCount")]),t._v(" {number} The number of "),s("code",[t._v("Http2Stream")]),t._v(" instances processed by\nthe "),s("code",[t._v("Http2Session")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("type")]),t._v(" {string} Either "),s("code",[t._v("'server'")]),t._v(" or "),s("code",[t._v("'client'")]),t._v(" to identify the type of\n"),s("code",[t._v("Http2Session")]),t._v(".")])])])}),[],!1,null,null,null);e.default=n.exports}}]);